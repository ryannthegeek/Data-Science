<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Data Visualization with R</title>
  <meta name="description" content="A guide to creating modern data visualizations with R. Starting with data preparation, topics include how to create effective univariate, bivariate, and multivariate graphs. In addition specialized graphs including geographic maps, the display of change over time, flow diagrams, interactive graphs, and graphs that help with the interpret statistical models are included. Focus is on the 45 most popular graph types. The guide also includes detailed instructions on how to customizing graphs, and ends with a chapter on graphing best practices. Although strongly based on the ggplot2 package, other approaches are included as well.">
  <meta name="generator" content="bookdown 0.7.3 and GitBook 2.6.7">

  <meta property="og:title" content="Data Visualization with R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://rkabacoff.github.io/datavis/" />
  <meta property="og:image" content="https://rkabacoff.github.io/datavis/img/cover.png" />
  <meta property="og:description" content="A guide to creating modern data visualizations with R. Starting with data preparation, topics include how to create effective univariate, bivariate, and multivariate graphs. In addition specialized graphs including geographic maps, the display of change over time, flow diagrams, interactive graphs, and graphs that help with the interpret statistical models are included. Focus is on the 45 most popular graph types. The guide also includes detailed instructions on how to customizing graphs, and ends with a chapter on graphing best practices. Although strongly based on the ggplot2 package, other approaches are included as well." />
  <meta name="github-repo" content="rkabacoff/datavis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Data Visualization with R" />
  
  <meta name="twitter:description" content="A guide to creating modern data visualizations with R. Starting with data preparation, topics include how to create effective univariate, bivariate, and multivariate graphs. In addition specialized graphs including geographic maps, the display of change over time, flow diagrams, interactive graphs, and graphs that help with the interpret statistical models are included. Focus is on the 45 most popular graph types. The guide also includes detailed instructions on how to customizing graphs, and ends with a chapter on graphing best practices. Although strongly based on the ggplot2 package, other approaches are included as well." />
  <meta name="twitter:image" content="https://rkabacoff.github.io/datavis/img/cover.png" />

<meta name="author" content="Rob Kabacoff">


<meta name="date" content="2018-09-03">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="Models.html">
<link rel="next" href="Customizing.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/d3-4.5.0/d3.min.js"></script>
<script src="libs/sankey-1/sankey.js"></script>
<script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script>
<link href="libs/leaflet-0.7.7/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-0.7.7/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<link href="libs/leaflet-label-0.2.2/leaflet.label.css" rel="stylesheet" />
<script src="libs/leaflet-label-0.2.2/leaflet.label.js"></script>
<script src="libs/Proj4Leaflet-0.7.2/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-0.7.2/proj4leaflet.js"></script>
<script src="libs/leaflet-binding-1.1.0/leaflet.js"></script>
<script src="libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>
<link href="libs/bokehjs-0.12.2/bokeh.min.css" rel="stylesheet" />
<link href="libs/bokehjs-0.12.2/loader.css" rel="stylesheet" />
<script src="libs/bokehjs-0.12.2/bokeh.min.js"></script>
<script src="libs/rbokeh-binding-0.5.0/rbokeh.js"></script>
<script src="libs/proj4js-2.3.15/proj4.js"></script>
<link href="libs/highcharts-5.0.6/css/motion.css" rel="stylesheet" />
<script src="libs/highcharts-5.0.6/highstock.js"></script>
<script src="libs/highcharts-5.0.6/highcharts-3d.js"></script>
<script src="libs/highcharts-5.0.6/highcharts-more.js"></script>
<script src="libs/highcharts-5.0.6/modules/annotations.js"></script>
<script src="libs/highcharts-5.0.6/modules/broken-axis.js"></script>
<script src="libs/highcharts-5.0.6/modules/data.js"></script>
<script src="libs/highcharts-5.0.6/modules/drilldown.js"></script>
<script src="libs/highcharts-5.0.6/modules/exporting.js"></script>
<script src="libs/highcharts-5.0.6/modules/funnel.js"></script>
<script src="libs/highcharts-5.0.6/modules/heatmap.js"></script>
<script src="libs/highcharts-5.0.6/modules/map.js"></script>
<script src="libs/highcharts-5.0.6/modules/no-data-to-display.js"></script>
<script src="libs/highcharts-5.0.6/modules/offline-exporting.js"></script>
<script src="libs/highcharts-5.0.6/modules/solid-gauge.js"></script>
<script src="libs/highcharts-5.0.6/modules/treemap.js"></script>
<script src="libs/highcharts-5.0.6/plugins/annotations.js"></script>
<script src="libs/highcharts-5.0.6/plugins/draggable-legend.js"></script>
<script src="libs/highcharts-5.0.6/plugins/draggable-points.js"></script>
<script src="libs/highcharts-5.0.6/plugins/export-csv.js"></script>
<script src="libs/highcharts-5.0.6/plugins/grouped-categories.js"></script>
<script src="libs/highcharts-5.0.6/plugins/motion.js"></script>
<script src="libs/highcharts-5.0.6/plugins/pattern-fill-v2.js"></script>
<script src="libs/highcharts-5.0.6/plugins/tooltip-delay.js"></script>
<script src="libs/highcharts-5.0.6/custom/reset.js"></script>
<script src="libs/highcharts-5.0.6/custom/symbols-extra.js"></script>
<script src="libs/highcharts-5.0.6/custom/text-symbols.js"></script>
<link href="libs/fontawesome-4.5.0/font-awesome.min.css" rel="stylesheet" />
<link href="libs/htmlwdgtgrid-1/htmlwdgtgrid.css" rel="stylesheet" />
<script src="libs/highchart-binding-0.5.0/highchart.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-122312673-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-122312673-1');
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Datavis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#how-to-use-this-book"><i class="fa fa-check"></i>How to use this book</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#prequisites"><i class="fa fa-check"></i>Prequisites</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#setup"><i class="fa fa-check"></i>Setup</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="DataPrep.html"><a href="DataPrep.html"><i class="fa fa-check"></i><b>1</b> Data Preparation</a><ul>
<li class="chapter" data-level="1.1" data-path="DataPrep.html"><a href="DataPrep.html#importing"><i class="fa fa-check"></i><b>1.1</b> Importing data</a><ul>
<li class="chapter" data-level="1.1.1" data-path="DataPrep.html"><a href="DataPrep.html#text-files"><i class="fa fa-check"></i><b>1.1.1</b> Text files</a></li>
<li class="chapter" data-level="1.1.2" data-path="DataPrep.html"><a href="DataPrep.html#excel-spreadsheets"><i class="fa fa-check"></i><b>1.1.2</b> Excel spreadsheets</a></li>
<li class="chapter" data-level="1.1.3" data-path="DataPrep.html"><a href="DataPrep.html#statistical-packages"><i class="fa fa-check"></i><b>1.1.3</b> Statistical packages</a></li>
<li class="chapter" data-level="1.1.4" data-path="DataPrep.html"><a href="DataPrep.html#databases"><i class="fa fa-check"></i><b>1.1.4</b> Databases</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="DataPrep.html"><a href="DataPrep.html#cleaning-data"><i class="fa fa-check"></i><b>1.2</b> Cleaning data</a><ul>
<li class="chapter" data-level="1.2.1" data-path="DataPrep.html"><a href="DataPrep.html#selecting-variables"><i class="fa fa-check"></i><b>1.2.1</b> Selecting variables</a></li>
<li class="chapter" data-level="1.2.2" data-path="DataPrep.html"><a href="DataPrep.html#selecting-observations"><i class="fa fa-check"></i><b>1.2.2</b> Selecting observations</a></li>
<li class="chapter" data-level="1.2.3" data-path="DataPrep.html"><a href="DataPrep.html#creatingrecoding-variables"><i class="fa fa-check"></i><b>1.2.3</b> Creating/Recoding variables</a></li>
<li class="chapter" data-level="1.2.4" data-path="DataPrep.html"><a href="DataPrep.html#summarizing-data"><i class="fa fa-check"></i><b>1.2.4</b> Summarizing data</a></li>
<li class="chapter" data-level="1.2.5" data-path="DataPrep.html"><a href="DataPrep.html#using-pipes"><i class="fa fa-check"></i><b>1.2.5</b> Using pipes</a></li>
<li class="chapter" data-level="1.2.6" data-path="DataPrep.html"><a href="DataPrep.html#Reshaping"><i class="fa fa-check"></i><b>1.2.6</b> Reshaping data</a></li>
<li class="chapter" data-level="1.2.7" data-path="DataPrep.html"><a href="DataPrep.html#missing-data"><i class="fa fa-check"></i><b>1.2.7</b> Missing data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="IntroGGPLOT.html"><a href="IntroGGPLOT.html"><i class="fa fa-check"></i><b>2</b> Introduction to ggplot2</a><ul>
<li class="chapter" data-level="2.1" data-path="IntroGGPLOT.html"><a href="IntroGGPLOT.html#a-worked-example"><i class="fa fa-check"></i><b>2.1</b> A worked example</a><ul>
<li class="chapter" data-level="2.1.1" data-path="IntroGGPLOT.html"><a href="IntroGGPLOT.html#ggplot"><i class="fa fa-check"></i><b>2.1.1</b> ggplot</a></li>
<li class="chapter" data-level="2.1.2" data-path="IntroGGPLOT.html"><a href="IntroGGPLOT.html#geoms"><i class="fa fa-check"></i><b>2.1.2</b> geoms</a></li>
<li class="chapter" data-level="2.1.3" data-path="IntroGGPLOT.html"><a href="IntroGGPLOT.html#grouping"><i class="fa fa-check"></i><b>2.1.3</b> grouping</a></li>
<li class="chapter" data-level="2.1.4" data-path="IntroGGPLOT.html"><a href="IntroGGPLOT.html#scales"><i class="fa fa-check"></i><b>2.1.4</b> scales</a></li>
<li class="chapter" data-level="2.1.5" data-path="IntroGGPLOT.html"><a href="IntroGGPLOT.html#facets"><i class="fa fa-check"></i><b>2.1.5</b> facets</a></li>
<li class="chapter" data-level="2.1.6" data-path="IntroGGPLOT.html"><a href="IntroGGPLOT.html#labels"><i class="fa fa-check"></i><b>2.1.6</b> labels</a></li>
<li class="chapter" data-level="2.1.7" data-path="IntroGGPLOT.html"><a href="IntroGGPLOT.html#themes"><i class="fa fa-check"></i><b>2.1.7</b> themes</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="IntroGGPLOT.html"><a href="IntroGGPLOT.html#placing-the-data-and-mapping-options"><i class="fa fa-check"></i><b>2.2</b> Placing the <code>data</code> and <code>mapping</code> options</a></li>
<li class="chapter" data-level="2.3" data-path="IntroGGPLOT.html"><a href="IntroGGPLOT.html#graphs-as-objects"><i class="fa fa-check"></i><b>2.3</b> Graphs as objects</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Univariate.html"><a href="Univariate.html"><i class="fa fa-check"></i><b>3</b> Univariate Graphs</a><ul>
<li class="chapter" data-level="3.1" data-path="Univariate.html"><a href="Univariate.html#categorical"><i class="fa fa-check"></i><b>3.1</b> Categorical</a><ul>
<li class="chapter" data-level="3.1.1" data-path="Univariate.html"><a href="Univariate.html#Barchart"><i class="fa fa-check"></i><b>3.1.1</b> Bar chart</a></li>
<li class="chapter" data-level="3.1.2" data-path="Univariate.html"><a href="Univariate.html#pie-chart"><i class="fa fa-check"></i><b>3.1.2</b> Pie chart</a></li>
<li class="chapter" data-level="3.1.3" data-path="Univariate.html"><a href="Univariate.html#tree-map"><i class="fa fa-check"></i><b>3.1.3</b> Tree map</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="Univariate.html"><a href="Univariate.html#quantitative"><i class="fa fa-check"></i><b>3.2</b> Quantitative</a><ul>
<li class="chapter" data-level="3.2.1" data-path="Univariate.html"><a href="Univariate.html#histogram"><i class="fa fa-check"></i><b>3.2.1</b> Histogram</a></li>
<li class="chapter" data-level="3.2.2" data-path="Univariate.html"><a href="Univariate.html#Kernel"><i class="fa fa-check"></i><b>3.2.2</b> Kernel Density plot</a></li>
<li class="chapter" data-level="3.2.3" data-path="Univariate.html"><a href="Univariate.html#dot-chart"><i class="fa fa-check"></i><b>3.2.3</b> Dot Chart</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Bivariate.html"><a href="Bivariate.html"><i class="fa fa-check"></i><b>4</b> Bivariate Graphs</a><ul>
<li class="chapter" data-level="4.1" data-path="Bivariate.html"><a href="Bivariate.html#Categorical-Categorical"><i class="fa fa-check"></i><b>4.1</b> Categorical vs. Categorical</a><ul>
<li class="chapter" data-level="4.1.1" data-path="Bivariate.html"><a href="Bivariate.html#stacked-bar-chart"><i class="fa fa-check"></i><b>4.1.1</b> Stacked bar chart</a></li>
<li class="chapter" data-level="4.1.2" data-path="Bivariate.html"><a href="Bivariate.html#grouped-bar-chart"><i class="fa fa-check"></i><b>4.1.2</b> Grouped bar chart</a></li>
<li class="chapter" data-level="4.1.3" data-path="Bivariate.html"><a href="Bivariate.html#segmented-bar-chart"><i class="fa fa-check"></i><b>4.1.3</b> Segmented bar chart</a></li>
<li class="chapter" data-level="4.1.4" data-path="Bivariate.html"><a href="Bivariate.html#improving-the-color-and-labeling"><i class="fa fa-check"></i><b>4.1.4</b> Improving the color and labeling</a></li>
<li class="chapter" data-level="4.1.5" data-path="Bivariate.html"><a href="Bivariate.html#other-plots"><i class="fa fa-check"></i><b>4.1.5</b> Other plots</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="Bivariate.html"><a href="Bivariate.html#quantitative-vs.quantitative"><i class="fa fa-check"></i><b>4.2</b> Quantitative vs. Quantitative</a><ul>
<li class="chapter" data-level="4.2.1" data-path="Bivariate.html"><a href="Bivariate.html#Scatterplot"><i class="fa fa-check"></i><b>4.2.1</b> Scatterplot</a></li>
<li class="chapter" data-level="4.2.2" data-path="Bivariate.html"><a href="Bivariate.html#Line"><i class="fa fa-check"></i><b>4.2.2</b> Line plot</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="Bivariate.html"><a href="Bivariate.html#categorical-vs.quantitative"><i class="fa fa-check"></i><b>4.3</b> Categorical vs. Quantitative</a><ul>
<li class="chapter" data-level="4.3.1" data-path="Bivariate.html"><a href="Bivariate.html#bar-chart-on-summary-statistics"><i class="fa fa-check"></i><b>4.3.1</b> Bar chart (on summary statistics)</a></li>
<li class="chapter" data-level="4.3.2" data-path="Bivariate.html"><a href="Bivariate.html#grouped-kernel-density-plots"><i class="fa fa-check"></i><b>4.3.2</b> Grouped kernel density plots</a></li>
<li class="chapter" data-level="4.3.3" data-path="Bivariate.html"><a href="Bivariate.html#box-plots"><i class="fa fa-check"></i><b>4.3.3</b> Box plots</a></li>
<li class="chapter" data-level="4.3.4" data-path="Bivariate.html"><a href="Bivariate.html#ViolinPlot"><i class="fa fa-check"></i><b>4.3.4</b> Violin plots</a></li>
<li class="chapter" data-level="4.3.5" data-path="Bivariate.html"><a href="Bivariate.html#ridgeline-plots"><i class="fa fa-check"></i><b>4.3.5</b> Ridgeline plots</a></li>
<li class="chapter" data-level="4.3.6" data-path="Bivariate.html"><a href="Bivariate.html#MeanSEM"><i class="fa fa-check"></i><b>4.3.6</b> Mean/SEM plots</a></li>
<li class="chapter" data-level="4.3.7" data-path="Bivariate.html"><a href="Bivariate.html#strip-plots"><i class="fa fa-check"></i><b>4.3.7</b> Strip plots</a></li>
<li class="chapter" data-level="4.3.8" data-path="Bivariate.html"><a href="Bivariate.html#beeswarm-plots"><i class="fa fa-check"></i><b>4.3.8</b> Beeswarm Plots</a></li>
<li class="chapter" data-level="4.3.9" data-path="Bivariate.html"><a href="Bivariate.html#cleveland-dot-charts"><i class="fa fa-check"></i><b>4.3.9</b> Cleveland Dot Charts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Multivariate.html"><a href="Multivariate.html"><i class="fa fa-check"></i><b>5</b> Multivariate Graphs</a><ul>
<li class="chapter" data-level="5.1" data-path="Multivariate.html"><a href="Multivariate.html#Grouping"><i class="fa fa-check"></i><b>5.1</b> Grouping</a></li>
<li class="chapter" data-level="5.2" data-path="Multivariate.html"><a href="Multivariate.html#Faceting"><i class="fa fa-check"></i><b>5.2</b> Faceting</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="GeoMaps.html"><a href="GeoMaps.html"><i class="fa fa-check"></i><b>6</b> Maps</a><ul>
<li class="chapter" data-level="6.1" data-path="GeoMaps.html"><a href="GeoMaps.html#dot-density-maps"><i class="fa fa-check"></i><b>6.1</b> Dot density maps</a></li>
<li class="chapter" data-level="6.2" data-path="GeoMaps.html"><a href="GeoMaps.html#choropleth-maps"><i class="fa fa-check"></i><b>6.2</b> Choropleth maps</a><ul>
<li class="chapter" data-level="6.2.1" data-path="GeoMaps.html"><a href="GeoMaps.html#data-by-country"><i class="fa fa-check"></i><b>6.2.1</b> Data by country</a></li>
<li class="chapter" data-level="6.2.2" data-path="GeoMaps.html"><a href="GeoMaps.html#data-by-us-state"><i class="fa fa-check"></i><b>6.2.2</b> Data by US state</a></li>
<li class="chapter" data-level="6.2.3" data-path="GeoMaps.html"><a href="GeoMaps.html#data-by-us-county"><i class="fa fa-check"></i><b>6.2.3</b> Data by US county</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Time.html"><a href="Time.html"><i class="fa fa-check"></i><b>7</b> Time-dependent graphs</a><ul>
<li class="chapter" data-level="7.1" data-path="Time.html"><a href="Time.html#TimeSeries"><i class="fa fa-check"></i><b>7.1</b> Time series</a></li>
<li class="chapter" data-level="7.2" data-path="Time.html"><a href="Time.html#dummbbell-charts"><i class="fa fa-check"></i><b>7.2</b> Dummbbell charts</a></li>
<li class="chapter" data-level="7.3" data-path="Time.html"><a href="Time.html#slope-graphs"><i class="fa fa-check"></i><b>7.3</b> Slope graphs</a></li>
<li class="chapter" data-level="7.4" data-path="Time.html"><a href="Time.html#area-charts"><i class="fa fa-check"></i><b>7.4</b> Area Charts</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Models.html"><a href="Models.html"><i class="fa fa-check"></i><b>8</b> Statistical Models</a><ul>
<li class="chapter" data-level="8.1" data-path="Models.html"><a href="Models.html#Corrplot"><i class="fa fa-check"></i><b>8.1</b> Correlation plots</a></li>
<li class="chapter" data-level="8.2" data-path="Models.html"><a href="Models.html#linear-regression"><i class="fa fa-check"></i><b>8.2</b> Linear Regression</a></li>
<li class="chapter" data-level="8.3" data-path="Models.html"><a href="Models.html#logistic-regression"><i class="fa fa-check"></i><b>8.3</b> Logistic regression</a></li>
<li class="chapter" data-level="8.4" data-path="Models.html"><a href="Models.html#survival-plots"><i class="fa fa-check"></i><b>8.4</b> Survival plots</a></li>
<li class="chapter" data-level="8.5" data-path="Models.html"><a href="Models.html#Mosaic"><i class="fa fa-check"></i><b>8.5</b> Mosaic plots</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Other.html"><a href="Other.html"><i class="fa fa-check"></i><b>9</b> Other Graphs</a><ul>
<li class="chapter" data-level="9.1" data-path="Other.html"><a href="Other.html#d-scatterplot"><i class="fa fa-check"></i><b>9.1</b> 3-D Scatterplot</a></li>
<li class="chapter" data-level="9.2" data-path="Other.html"><a href="Other.html#biplots"><i class="fa fa-check"></i><b>9.2</b> Biplots</a></li>
<li class="chapter" data-level="9.3" data-path="Other.html"><a href="Other.html#Bubble"><i class="fa fa-check"></i><b>9.3</b> Bubble charts</a></li>
<li class="chapter" data-level="9.4" data-path="Other.html"><a href="Other.html#flow-diagrams"><i class="fa fa-check"></i><b>9.4</b> Flow diagrams</a><ul>
<li class="chapter" data-level="9.4.1" data-path="Other.html"><a href="Other.html#sankey-diagrams"><i class="fa fa-check"></i><b>9.4.1</b> Sankey diagrams</a></li>
<li class="chapter" data-level="9.4.2" data-path="Other.html"><a href="Other.html#alluvial-diagrams"><i class="fa fa-check"></i><b>9.4.2</b> Alluvial diagrams</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="Other.html"><a href="Other.html#heatmaps"><i class="fa fa-check"></i><b>9.5</b> Heatmaps</a></li>
<li class="chapter" data-level="9.6" data-path="Other.html"><a href="Other.html#radar-charts"><i class="fa fa-check"></i><b>9.6</b> Radar charts</a></li>
<li class="chapter" data-level="9.7" data-path="Other.html"><a href="Other.html#scatterplot-matrix"><i class="fa fa-check"></i><b>9.7</b> Scatterplot matrix</a></li>
<li class="chapter" data-level="9.8" data-path="Other.html"><a href="Other.html#waterfall-charts"><i class="fa fa-check"></i><b>9.8</b> Waterfall charts</a></li>
<li class="chapter" data-level="9.9" data-path="Other.html"><a href="Other.html#word-clouds"><i class="fa fa-check"></i><b>9.9</b> Word clouds</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Customizing.html"><a href="Customizing.html"><i class="fa fa-check"></i><b>10</b> Customizing Graphs</a><ul>
<li class="chapter" data-level="10.1" data-path="Customizing.html"><a href="Customizing.html#axes"><i class="fa fa-check"></i><b>10.1</b> Axes</a><ul>
<li class="chapter" data-level="10.1.1" data-path="Customizing.html"><a href="Customizing.html#quantitative-axes"><i class="fa fa-check"></i><b>10.1.1</b> Quantitative axes</a></li>
<li class="chapter" data-level="10.1.2" data-path="Customizing.html"><a href="Customizing.html#categorical-axes"><i class="fa fa-check"></i><b>10.1.2</b> Categorical axes</a></li>
<li class="chapter" data-level="10.1.3" data-path="Customizing.html"><a href="Customizing.html#Dates"><i class="fa fa-check"></i><b>10.1.3</b> Date axes</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="Customizing.html"><a href="Customizing.html#colors"><i class="fa fa-check"></i><b>10.2</b> Colors</a><ul>
<li class="chapter" data-level="10.2.1" data-path="Customizing.html"><a href="Customizing.html#specifying-colors-manually"><i class="fa fa-check"></i><b>10.2.1</b> Specifying colors manually</a></li>
<li class="chapter" data-level="10.2.2" data-path="Customizing.html"><a href="Customizing.html#color-palettes"><i class="fa fa-check"></i><b>10.2.2</b> Color palettes</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="Customizing.html"><a href="Customizing.html#points-lines"><i class="fa fa-check"></i><b>10.3</b> Points &amp; Lines</a><ul>
<li class="chapter" data-level="10.3.1" data-path="Customizing.html"><a href="Customizing.html#points"><i class="fa fa-check"></i><b>10.3.1</b> Points</a></li>
<li class="chapter" data-level="10.3.2" data-path="Customizing.html"><a href="Customizing.html#lines"><i class="fa fa-check"></i><b>10.3.2</b> Lines</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="Customizing.html"><a href="Customizing.html#fonts"><i class="fa fa-check"></i><b>10.4</b> Fonts</a></li>
<li class="chapter" data-level="10.5" data-path="Customizing.html"><a href="Customizing.html#legends"><i class="fa fa-check"></i><b>10.5</b> Legends</a><ul>
<li class="chapter" data-level="10.5.1" data-path="Customizing.html"><a href="Customizing.html#legend-location"><i class="fa fa-check"></i><b>10.5.1</b> Legend location</a></li>
<li class="chapter" data-level="10.5.2" data-path="Customizing.html"><a href="Customizing.html#legend-title"><i class="fa fa-check"></i><b>10.5.2</b> Legend title</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="Customizing.html"><a href="Customizing.html#labels-1"><i class="fa fa-check"></i><b>10.6</b> Labels</a></li>
<li class="chapter" data-level="10.7" data-path="Customizing.html"><a href="Customizing.html#Annotations"><i class="fa fa-check"></i><b>10.7</b> Annotations</a><ul>
<li class="chapter" data-level="10.7.1" data-path="Customizing.html"><a href="Customizing.html#adding-text"><i class="fa fa-check"></i><b>10.7.1</b> Adding text</a></li>
<li class="chapter" data-level="10.7.2" data-path="Customizing.html"><a href="Customizing.html#adding-lines"><i class="fa fa-check"></i><b>10.7.2</b> Adding lines</a></li>
<li class="chapter" data-level="10.7.3" data-path="Customizing.html"><a href="Customizing.html#highlighting-a-single-group"><i class="fa fa-check"></i><b>10.7.3</b> Highlighting a single group</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="Customizing.html"><a href="Customizing.html#themes-1"><i class="fa fa-check"></i><b>10.8</b> Themes</a><ul>
<li class="chapter" data-level="10.8.1" data-path="Customizing.html"><a href="Customizing.html#altering-theme-elements"><i class="fa fa-check"></i><b>10.8.1</b> Altering theme elements</a></li>
<li class="chapter" data-level="10.8.2" data-path="Customizing.html"><a href="Customizing.html#pre-packaged-themes"><i class="fa fa-check"></i><b>10.8.2</b> Pre-packaged themes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="SavingGraphs.html"><a href="SavingGraphs.html"><i class="fa fa-check"></i><b>11</b> Saving Graphs</a><ul>
<li class="chapter" data-level="11.1" data-path="SavingGraphs.html"><a href="SavingGraphs.html#via-menus"><i class="fa fa-check"></i><b>11.1</b> Via menus</a></li>
<li class="chapter" data-level="11.2" data-path="SavingGraphs.html"><a href="SavingGraphs.html#SavingGraphsProgrammatically"><i class="fa fa-check"></i><b>11.2</b> Via code</a></li>
<li class="chapter" data-level="11.3" data-path="SavingGraphs.html"><a href="SavingGraphs.html#file-formats"><i class="fa fa-check"></i><b>11.3</b> File formats</a></li>
<li class="chapter" data-level="11.4" data-path="SavingGraphs.html"><a href="SavingGraphs.html#external-editing"><i class="fa fa-check"></i><b>11.4</b> External editing</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="Interactive.html"><a href="Interactive.html"><i class="fa fa-check"></i><b>12</b> Interactive Graphs</a><ul>
<li class="chapter" data-level="12.1" data-path="Interactive.html"><a href="Interactive.html#leaflet"><i class="fa fa-check"></i><b>12.1</b> leaflet</a></li>
<li class="chapter" data-level="12.2" data-path="Interactive.html"><a href="Interactive.html#plotly"><i class="fa fa-check"></i><b>12.2</b> plotly</a></li>
<li class="chapter" data-level="12.3" data-path="Interactive.html"><a href="Interactive.html#rbokeh"><i class="fa fa-check"></i><b>12.3</b> rbokeh</a></li>
<li class="chapter" data-level="12.4" data-path="Interactive.html"><a href="Interactive.html#rcharts"><i class="fa fa-check"></i><b>12.4</b> rCharts</a></li>
<li class="chapter" data-level="12.5" data-path="Interactive.html"><a href="Interactive.html#highcharter"><i class="fa fa-check"></i><b>12.5</b> highcharter</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="Advice.html"><a href="Advice.html"><i class="fa fa-check"></i><b>13</b> Advice / Best Practices</a><ul>
<li class="chapter" data-level="13.1" data-path="Advice.html"><a href="Advice.html#labeling"><i class="fa fa-check"></i><b>13.1</b> Labeling</a></li>
<li class="chapter" data-level="13.2" data-path="Advice.html"><a href="Advice.html#signal-to-noise-ratio"><i class="fa fa-check"></i><b>13.2</b> Signal to noise ratio</a></li>
<li class="chapter" data-level="13.3" data-path="Advice.html"><a href="Advice.html#ColorChoice"><i class="fa fa-check"></i><b>13.3</b> Color choice</a></li>
<li class="chapter" data-level="13.4" data-path="Advice.html"><a href="Advice.html#y-axis-scaling"><i class="fa fa-check"></i><b>13.4</b> <em>y</em>-Axis scaling</a></li>
<li class="chapter" data-level="13.5" data-path="Advice.html"><a href="Advice.html#attribution"><i class="fa fa-check"></i><b>13.5</b> Attribution</a></li>
<li class="chapter" data-level="13.6" data-path="Advice.html"><a href="Advice.html#going-further"><i class="fa fa-check"></i><b>13.6</b> Going further</a></li>
<li class="chapter" data-level="13.7" data-path="Advice.html"><a href="Advice.html#final-note"><i class="fa fa-check"></i><b>13.7</b> Final Note</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="Data.html"><a href="Data.html"><i class="fa fa-check"></i><b>A</b> Datasets</a><ul>
<li class="chapter" data-level="A.1" data-path="Data.html"><a href="Data.html#Salaries"><i class="fa fa-check"></i><b>A.1</b> Academic salaries</a></li>
<li class="chapter" data-level="A.2" data-path="Data.html"><a href="Data.html#Starwars"><i class="fa fa-check"></i><b>A.2</b> Starwars</a></li>
<li class="chapter" data-level="A.3" data-path="Data.html"><a href="Data.html#Msleep"><i class="fa fa-check"></i><b>A.3</b> Mammal sleep</a></li>
<li class="chapter" data-level="A.4" data-path="Data.html"><a href="Data.html#Marriage"><i class="fa fa-check"></i><b>A.4</b> Marriage records</a></li>
<li class="chapter" data-level="A.5" data-path="Data.html"><a href="Data.html#MPG"><i class="fa fa-check"></i><b>A.5</b> Fuel economy data</a></li>
<li class="chapter" data-level="A.6" data-path="Data.html"><a href="Data.html#Gapminder"><i class="fa fa-check"></i><b>A.6</b> Gapminder data</a></li>
<li class="chapter" data-level="A.7" data-path="Data.html"><a href="Data.html#CPS85"><i class="fa fa-check"></i><b>A.7</b> Current Population Survey (1985)</a></li>
<li class="chapter" data-level="A.8" data-path="Data.html"><a href="Data.html#HoustonCrime"><i class="fa fa-check"></i><b>A.8</b> Houston crime data</a></li>
<li class="chapter" data-level="A.9" data-path="Data.html"><a href="Data.html#Economic"><i class="fa fa-check"></i><b>A.9</b> US economic timeseries</a></li>
<li class="chapter" data-level="A.10" data-path="Data.html"><a href="Data.html#SaratogaHousing"><i class="fa fa-check"></i><b>A.10</b> Saratoga housing data</a></li>
<li class="chapter" data-level="A.11" data-path="Data.html"><a href="Data.html#USpop"><i class="fa fa-check"></i><b>A.11</b> US population by age and year</a></li>
<li class="chapter" data-level="A.12" data-path="Data.html"><a href="Data.html#Lung"><i class="fa fa-check"></i><b>A.12</b> NCCTG lung cancer data</a></li>
<li class="chapter" data-level="A.13" data-path="Data.html"><a href="Data.html#Titanic"><i class="fa fa-check"></i><b>A.13</b> Titanic data</a></li>
<li class="chapter" data-level="A.14" data-path="Data.html"><a href="Data.html#JFKspeech"><i class="fa fa-check"></i><b>A.14</b> JFK Cuban Missle speech</a></li>
<li class="chapter" data-level="A.15" data-path="Data.html"><a href="Data.html#UKEnergy"><i class="fa fa-check"></i><b>A.15</b> UK Energy forecast data</a></li>
<li class="chapter" data-level="A.16" data-path="Data.html"><a href="Data.html#MexicanAmerican"><i class="fa fa-check"></i><b>A.16</b> US Mexican American Population</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i><b>B</b> About the Author</a></li>
<li class="chapter" data-level="C" data-path="QAC.html"><a href="QAC.html"><i class="fa fa-check"></i><b>C</b> About the QAC</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Visualization with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Other" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Other Graphs</h1>
<p>Graphs in this chapter can be very useful, but don’t fit in easily within the other chapters.</p>
<div id="d-scatterplot" class="section level2">
<h2><span class="header-section-number">9.1</span> 3-D Scatterplot</h2>
<p>The <code>ggplot2</code> package and its extensions can’t create a 3-D plot. However, you can create a 3-D scatterplot with the <code>scatterplot3d</code> function in the <code>scatterplot3d</code> package.</p>
<p>Let’s say that we want to plot automobile mileage vs. engine displacement vs. car weight using the data in the <code>mtcars</code> dataframe.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># basic 3-D scatterplot</span>
<span class="kw">library</span>(scatterplot3d)
<span class="kw">with</span>(mtcars, {
   <span class="kw">scatterplot3d</span>(<span class="dt">x =</span> disp,
                 <span class="dt">y =</span> wt, 
                 <span class="dt">z =</span> mpg,
                 <span class="dt">main=</span><span class="st">&quot;3-D Scatterplot Example 1&quot;</span>)
})</code></pre></div>
<div class="figure"><span id="fig:scatterplot3d1"></span>
<img src="datavis_files/figure-html/scatterplot3d1-1.png" alt="Basic 3-D scatterplot" width="576" />
<p class="caption">
Figure 9.1: Basic 3-D scatterplot
</p>
</div>
<p>Now lets, modify the graph by replacing the points with filled blue circles, add drop lines to the x-y plane, and create more meaningful labels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(scatterplot3d)
<span class="kw">with</span>(mtcars, {
  <span class="kw">scatterplot3d</span>(<span class="dt">x =</span> disp, 
                <span class="dt">y =</span> wt, 
                <span class="dt">z =</span> mpg, 
                <span class="co"># filled blue circles</span>
                <span class="dt">color=</span><span class="st">&quot;blue&quot;</span>, 
                <span class="dt">pch=</span><span class="dv">19</span>, 
                <span class="co"># lines to the horizontal plane</span>
                <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>,
                <span class="dt">main =</span> <span class="st">&quot;3-D Scatterplot Example 2&quot;</span>,
                <span class="dt">xlab =</span> <span class="st">&quot;Displacement (cu. in.)&quot;</span>,
                <span class="dt">ylab =</span> <span class="st">&quot;Weight (lb/1000)&quot;</span>,
                <span class="dt">zlab =</span> <span class="st">&quot;Miles/(US) Gallon&quot;</span>)
})</code></pre></div>
<div class="figure"><span id="fig:scatterplot3d2"></span>
<img src="datavis_files/figure-html/scatterplot3d2-1.png" alt="3-D scatterplot with vertical lines" width="576" />
<p class="caption">
Figure 9.2: 3-D scatterplot with vertical lines
</p>
</div>
<p>Next, let’s label the points. We can do this by saving the results of the <code>scatterplot3d</code> function to an object, using the <code>xyz.convert</code> function to convert coordinates from 3-D (x, y, z) to 2D-projections (x, y), and apply the <code>text</code> function to add labels to the graph.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(scatterplot3d)
<span class="kw">with</span>(mtcars, {
  s3d &lt;-<span class="st"> </span><span class="kw">scatterplot3d</span>(
    <span class="dt">x =</span> disp, 
    <span class="dt">y =</span> wt, 
    <span class="dt">z =</span> mpg,
    <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, 
    <span class="dt">pch =</span> <span class="dv">19</span>,      
    <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>,
    <span class="dt">main =</span> <span class="st">&quot;3-D Scatterplot Example 3&quot;</span>,
    <span class="dt">xlab =</span> <span class="st">&quot;Displacement (cu. in.)&quot;</span>,
    <span class="dt">ylab =</span> <span class="st">&quot;Weight (lb/1000)&quot;</span>,
    <span class="dt">zlab =</span> <span class="st">&quot;Miles/(US) Gallon&quot;</span>)
  
  <span class="co"># convert 3-D coords to 2D projection</span>
  s3d.coords &lt;-<span class="st"> </span>s3d<span class="op">$</span><span class="kw">xyz.convert</span>(disp, wt, mpg) 
  
  <span class="co"># plot text with 50% shrink and place to right of points</span>
  <span class="kw">text</span>(s3d.coords<span class="op">$</span>x, 
       s3d.coords<span class="op">$</span>y,   
       <span class="dt">labels =</span> <span class="kw">row.names</span>(mtcars),  
       <span class="dt">cex =</span> .<span class="dv">5</span>, 
       <span class="dt">pos =</span> <span class="dv">4</span>)
})</code></pre></div>
<div class="figure"><span id="fig:scatterplot3d3"></span>
<img src="datavis_files/figure-html/scatterplot3d3-1.png" alt="3-D scatterplot with vertical lines and point labels" width="576" />
<p class="caption">
Figure 9.3: 3-D scatterplot with vertical lines and point labels
</p>
</div>
<p>Almost there. As a final step, we will add information on the number of cylinders in each car. To do this, we’ll add a column to the <code>mtcars</code> dataframe indicating the color for each point. For good measure, we will shorten the <em>y</em>-axis, change the drop lines to dashed lines, and add a legend.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(scatterplot3d)

<span class="co"># create column indicating point color</span>
mtcars<span class="op">$</span>pcolor[mtcars<span class="op">$</span>cyl <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] &lt;-<span class="st"> &quot;red&quot;</span>
mtcars<span class="op">$</span>pcolor[mtcars<span class="op">$</span>cyl <span class="op">==</span><span class="st"> </span><span class="dv">6</span>] &lt;-<span class="st"> &quot;blue&quot;</span>
mtcars<span class="op">$</span>pcolor[mtcars<span class="op">$</span>cyl <span class="op">==</span><span class="st"> </span><span class="dv">8</span>] &lt;-<span class="st"> &quot;darkgreen&quot;</span>

<span class="kw">with</span>(mtcars, {
    s3d &lt;-<span class="st"> </span><span class="kw">scatterplot3d</span>(
      <span class="dt">x =</span> disp, 
      <span class="dt">y =</span> wt, 
      <span class="dt">z =</span> mpg,
      <span class="dt">color =</span> pcolor, 
      <span class="dt">pch =</span> <span class="dv">19</span>, 
      <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, 
      <span class="dt">lty.hplot =</span> <span class="dv">2</span>, 
      <span class="dt">scale.y =</span> .<span class="dv">75</span>,
      <span class="dt">main =</span> <span class="st">&quot;3-D Scatterplot Example 4&quot;</span>,
      <span class="dt">xlab =</span> <span class="st">&quot;Displacement (cu. in.)&quot;</span>,
      <span class="dt">ylab =</span> <span class="st">&quot;Weight (lb/1000)&quot;</span>,
      <span class="dt">zlab =</span> <span class="st">&quot;Miles/(US) Gallon&quot;</span>)
    
     s3d.coords &lt;-<span class="st"> </span>s3d<span class="op">$</span><span class="kw">xyz.convert</span>(disp, wt, mpg)
     <span class="kw">text</span>(s3d.coords<span class="op">$</span>x, 
          s3d.coords<span class="op">$</span>y, 
          <span class="dt">labels =</span> <span class="kw">row.names</span>(mtcars), 
          <span class="dt">pos =</span> <span class="dv">4</span>, 
          <span class="dt">cex =</span> .<span class="dv">5</span>)  
     
<span class="co"># add the legend</span>
<span class="kw">legend</span>(<span class="co">#location</span>
       <span class="st">&quot;topleft&quot;</span>, 
       <span class="dt">inset=</span>.<span class="dv">05</span>,
       <span class="co"># suppress legend box, shrink text 50%</span>
       <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>, 
       <span class="dt">cex=</span>.<span class="dv">5</span>, 
       <span class="dt">title=</span><span class="st">&quot;Number of Cylinders&quot;</span>,
       <span class="kw">c</span>(<span class="st">&quot;4&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;8&quot;</span>), 
       <span class="dt">fill=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>))
})</code></pre></div>
<div class="figure"><span id="fig:scatterplot3d4"></span>
<img src="datavis_files/figure-html/scatterplot3d4-1.png" alt="3-D scatterplot with vertical lines and point labels and legend" width="576" />
<p class="caption">
Figure 9.4: 3-D scatterplot with vertical lines and point labels and legend
</p>
</div>
<p>We can easily see that the car with the highest mileage (Toyota Corolla) has low engine displacement, low weight, and 4 cylinders.</p>
</div>
<div id="biplots" class="section level2">
<h2><span class="header-section-number">9.2</span> Biplots</h2>
<p>A biplot is a specialized graph that attempts to represent the relationship between observations, between variables, and between observations and variables, in a low (usually two) dimensional space.</p>
<p>It’s easiest to see how this works with an example. Let’s create a biplot for the <a href="https://www.rdocumentation.org/packages/datasets/versions/3.5.0/topics/mtcars"><code>mtcars</code></a> dataset, using the <code>fviz_pca</code> function from the <code>factoextra</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create a biplot</span>
<span class="co"># load data</span>
<span class="kw">data</span>(mtcars)

<span class="co"># fit a principal components model</span>
fit &lt;-<span class="st"> </span><span class="kw">prcomp</span>(<span class="dt">x =</span> mtcars, 
              <span class="dt">center =</span> <span class="ot">TRUE</span>, 
              <span class="dt">scale =</span> <span class="ot">TRUE</span>)

<span class="co"># plot the results</span>
<span class="kw">library</span>(factoextra)
<span class="kw">fviz_pca</span>(fit, 
         <span class="dt">repel =</span> <span class="ot">TRUE</span>, 
         <span class="dt">labelsize =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Biplot of mtcars data&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:biplot1"></span>
<img src="datavis_files/figure-html/biplot1-1.png" alt="Basic biplot" width="672" />
<p class="caption">
Figure 9.5: Basic biplot
</p>
</div>
<p>The <code>fviz_pca</code> function produces a <code>ggplot2</code> graph.</p>
<p><em>Dim1</em> and <em>Dim2</em> are the first two <a href="https://towardsdatascience.com/a-one-stop-shop-for-principal-component-analysis-5582fb7e0a9c">principal components</a> - linear combinations of the original <em>p</em> variables.</p>
<p><span class="math display">\[PC_{1} = \beta_{10} +\beta_{11}x_{1} + \beta_{12}x_{2} + \beta_{13}x_{3} +   \dots +  \beta_{1p}x_{p}\]</span> <span class="math display">\[PC_{2} = \beta_{20} +\beta_{21}x_{1} + \beta_{22}x_{2} + \beta_{23}x_{3} +   \dots +  \beta_{2p}x_{p}\]</span></p>
<p>The weights of these linear combinations (<span class="math inline">\(\beta_{ij}s\)</span>) are chosen to maximize the variance accounted for in the original variables. Additionally, the principal components (PCs) are constrained to be uncorrelated with each other.</p>
<p>In this graph, the first PC accounts for 60% of the variability in the original data. The second PC accounts for 24%. Together, they account for 84% of the variability in the original <em>p</em> = 11 variables.</p>
<p>As you can see, both the observations (cars) and variables (car characteristics) are plotted in the same graph.</p>
<ul>
<li>Points represent observations. Smaller distances between points suggest similar values on the original set of variables. For example, the <em>Toyota Corolla</em> and <em>Honda Civic</em> are similar to each other, as are the <em>Chrysler Imperial</em> and <em>Liconln Continental</em>. However, the <em>Toyota Corolla</em> is very different from the <em>Lincoln Continental</em>.<br />
</li>
<li>The vectors (arrows) represent variables. The angle between vectors are proportional to the correlation between the variables. Smaller angles indicate stronger correlations. For example, <em>gear</em> and <em>am</em> are positively correlated, <em>gear</em> and <em>qsec</em> are uncorrelated (90 degree angle), and <em>am</em> and <em>wt</em> are negatively correlated (angle greater then 90 degrees).<br />
</li>
<li>The observations that are are farthest along the direction of a variable’s vector, have the highest values on that variable. For example, the <em>Toyoto Corolla</em> and <em>Honda Civic</em> have higher values on <em>mpg</em>. The <em>Toyota Corona</em> has a higher <em>qsec</em>. The <em>Duster 360</em> has more <em>cylinders</em>.</li>
</ul>
<p>Care must be taken in interpreting biplots. They are only accurate when the percentage of variance accounted for is high. Always check your conclusion with the original data.</p>
<p>See the article by <a href="http://forrest.psych.unc.edu/research/vista-frames/help/lecturenotes/lecture13/biplot.html">Forrest Young</a> to learn more about interpreting biplots correctly.</p>
</div>
<div id="Bubble" class="section level2">
<h2><span class="header-section-number">9.3</span> Bubble charts</h2>
<p>A bubble chart is basically just a scatterplot where the point size is proportional to the values of a third quantitative variable.</p>
<p>Using the <a href="https://www.rdocumentation.org/packages/datasets/versions/3.5.0/topics/mtcars">mtcars</a> dataset, let’s plot car weight vs. mileage and use point size to represent horsepower.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create a bubble plot</span>
<span class="kw">data</span>(mtcars)
<span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(mtcars, 
       <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg, <span class="dt">size =</span> hp)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre></div>
<div class="figure"><span id="fig:bubbleplot1"></span>
<img src="datavis_files/figure-html/bubbleplot1-1.png" alt="Basic bubble plot" width="672" />
<p class="caption">
Figure 9.6: Basic bubble plot
</p>
</div>
<p>We can improve the default appearance by increasing the size of the bubbles, choosing a different point shape and color, and adding some transparency.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create a bubble plot with modifications</span>
<span class="kw">ggplot</span>(mtcars, 
       <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg, <span class="dt">size =</span> hp)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> .<span class="dv">5</span>, 
             <span class="dt">fill=</span><span class="st">&quot;cornflowerblue&quot;</span>, 
             <span class="dt">color=</span><span class="st">&quot;black&quot;</span>, 
             <span class="dt">shape=</span><span class="dv">21</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_size_continuous</span>(<span class="dt">range =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">14</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Auto mileage by weight and horsepower&quot;</span>,
       <span class="dt">subtitle =</span> <span class="st">&quot;Motor Trend US Magazine (1973-74 models)&quot;</span>,
       <span class="dt">x =</span> <span class="st">&quot;Weight (1000 lbs)&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Miles/(US) gallon&quot;</span>,
       <span class="dt">size =</span> <span class="st">&quot;Gross horsepower&quot;</span>) </code></pre></div>
<div class="figure"><span id="fig:bubbleplot2"></span>
<img src="datavis_files/figure-html/bubbleplot2-1.png" alt="Bubble plot with modifications" width="672" />
<p class="caption">
Figure 9.7: Bubble plot with modifications
</p>
</div>
<p>The <code>range</code> parameter in the <code>scale_size_continuous</code> function specifies the minimum and maximum size of the plotting symbol. The default is <code>range = c(1, 6)</code>.</p>
<p>The <code>shape</code> option in the <code>geom_point</code> function specifies an circle with a border color and fill color.</p>
<p>Clearly, miles per gallon decreases with increased car weight and horsepower. However, there is one car with low weight, high horsepower, and high gas mileage. Going back to the data, it’s the Lotus Europa.</p>
<p>Bubble charts are controversial for the same reason that pie charts are controversial. People are better at judging length than volume. However, they are quite popular.</p>
</div>
<div id="flow-diagrams" class="section level2">
<h2><span class="header-section-number">9.4</span> Flow diagrams</h2>
<p>A flow diagram represents a set of dynamic relationships. It usually captures the physical or metaphorical flow of people, materials, communications, or objects through a set of nodes in a network.</p>
<div id="sankey-diagrams" class="section level3">
<h3><span class="header-section-number">9.4.1</span> Sankey diagrams</h3>
<p>In a Sankey diagram, the width of the line between two nodes is proportional to the flow amount. We’ll demonstrate this with <a href="Data.html#UKEnergy">UK energy forecast</a> data. The data contain energy production and consumption forecasts for the year 2050.</p>
<p>Building the graph requires two data frames, one containing node names and the second containing the links between the nodes and the amount of the flow between them.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># input data (data frames nodes and links)</span>
<span class="kw">load</span>(<span class="st">&quot;Energy.RData&quot;</span>)

<span class="co"># view nodes data frame</span>
<span class="kw">head</span>(nodes)</code></pre></div>
<pre><code>## # A tibble: 6 x 1
##   name                
##   &lt;chr&gt;               
## 1 Agricultural &#39;waste&#39;
## 2 Bio-conversion      
## 3 Liquid              
## 4 Losses              
## 5 Solid               
## 6 Gas</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># view links data frame</span>
<span class="kw">head</span>(links)</code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   source target   value
##    &lt;int&gt;  &lt;int&gt;   &lt;dbl&gt;
## 1      0      1 125.   
## 2      1      2   0.597
## 3      1      3  26.9  
## 4      1      4 280.   
## 5      1      5  81.1  
## 6      6      2  35.0</code></pre>
<p>We’ll build the diagram using the <a href="https://www.rdocumentation.org/packages/networkD3/versions/0.4/topics/sankeyNetwork"><code>sankeyNetwork</code></a> function in the <code>networkD3</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create Sankey diagram</span>
<span class="kw">library</span>(networkD3)
<span class="kw">sankeyNetwork</span>(<span class="dt">Links =</span> links, 
              <span class="dt">Nodes =</span> nodes, 
              <span class="dt">Source =</span> <span class="st">&quot;source&quot;</span>,
              <span class="dt">Target =</span> <span class="st">&quot;target&quot;</span>, 
              <span class="dt">Value =</span> <span class="st">&quot;value&quot;</span>, 
              <span class="dt">NodeID =</span> <span class="st">&quot;name&quot;</span>,
              <span class="dt">units =</span> <span class="st">&quot;TWh&quot;</span>, <span class="co"># optional units name for popups</span>
              <span class="dt">fontSize =</span> <span class="dv">12</span>, 
              <span class="dt">nodeWidth =</span> <span class="dv">30</span>)</code></pre></div>
<div class="figure"><span id="fig:sankey2"></span>
<div id="htmlwidget-ddbfab9e5f87df94d64f" style="width:672px;height:480px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-ddbfab9e5f87df94d64f">{"x":{"links":{"source":[0,1,1,1,1,6,7,8,10,9,11,11,11,15,15,15,15,15,15,15,15,15,15,15,23,25,5,5,5,5,5,27,17,17,28,29,2,2,2,2,2,2,2,2,34,24,35,35,36,38,37,39,39,40,40,41,42,43,43,4,4,4,26,26,26,44,45,46,47,35,35],"target":[1,2,3,4,5,2,4,9,9,4,12,13,14,16,14,17,12,18,19,13,3,20,21,22,24,24,13,3,26,19,12,15,28,3,18,15,12,30,18,31,32,19,33,20,1,5,26,26,37,37,2,4,1,14,13,15,14,42,41,19,26,12,15,3,11,15,1,15,15,26,26],"value":[124.729,0.597,26.862,280.322,81.144,35,35,11.606,63.965,75.571,10.639,22.505,46.184,104.453,113.726,27.14,342.165,37.797,4.412,40.858,56.691,7.863,90.008,93.494,40.719,82.233,0.129,1.401,151.891,2.096,48.58,7.013,20.897,6.242,20.897,6.995,121.066,128.69,135.835,14.458,206.267,3.64,33.218,4.413,14.375,122.952,500,139.978,504.287,107.703,611.99,56.587,77.81,193.026,70.672,59.901,19.263,19.263,59.901,0.882,400.12,46.477,525.531,787.129,79.329,9.452,182.01,19.013,289.366,100,100]},"nodes":{"name":["Agricultural 'waste'","Bio-conversion","Liquid","Losses","Solid","Gas","Biofuel imports","Biomass imports","Coal imports","Coal","Coal reserves","District heating","Industry","Heating and cooling - commercial","Heating and cooling - homes","Electricity grid","Over generation / exports","H2 conversion","Road transport","Agriculture","Rail transport","Lighting & appliances - commercial","Lighting & appliances - homes","Gas imports","Ngas","Gas reserves","Thermal generation","Geothermal","H2","Hydro","International shipping","Domestic aviation","International aviation","National navigation","Marine algae","Nuclear","Oil imports","Oil","Oil reserves","Other waste","Pumped heat","Solar PV","Solar Thermal","Solar","Tidal","UK land based bioenergy","Wave","Wind"],"group":["Agricultural 'waste'","Bio-conversion","Liquid","Losses","Solid","Gas","Biofuel imports","Biomass imports","Coal imports","Coal","Coal reserves","District heating","Industry","Heating and cooling - commercial","Heating and cooling - homes","Electricity grid","Over generation / exports","H2 conversion","Road transport","Agriculture","Rail transport","Lighting & appliances - commercial","Lighting & appliances - homes","Gas imports","Ngas","Gas reserves","Thermal generation","Geothermal","H2","Hydro","International shipping","Domestic aviation","International aviation","National navigation","Marine algae","Nuclear","Oil imports","Oil","Oil reserves","Other waste","Pumped heat","Solar PV","Solar Thermal","Solar","Tidal","UK land based bioenergy","Wave","Wind"]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":12,"fontFamily":null,"nodeWidth":30,"nodePadding":10,"units":"TWh","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 9.8: Sankey diagram
</p>
</div>
<p>Energy supplies are on the left and energy demands are on the right. Follow the flow from left to right. Notice that the graph is interactive (assuming you are viewing it on a web page). Try highlighting nodes and dragging them to new positions.</p>
<p>Sankey diagrams created with the <code>networkD3</code> package are <em>not</em> <code>ggplot2</code> graphs. Therefore, they can not be modified with <code>ggplot2</code> functions.</p>
</div>
<div id="alluvial-diagrams" class="section level3">
<h3><span class="header-section-number">9.4.2</span> Alluvial diagrams</h3>
<p>Alluvial diagrams are a subset of Sankey diagrams, and are more rigidly defined. A discussion of the differences can be found <a href="https://github.com/corybrunson/ggalluvial/issues/11">here</a>.</p>
<p>When examining the relationship among categorical variables, alluvial diagrams can serve as alternatives to <a href="Models.html#Mosaic">mosaic</a> plots. In an alluvial diagram, blocks represent clusters of observations, and stream fields between the blocks represent changes to the composition of the clusters over time.</p>
<p>They can also be used when time is not a factor. As an example, let’s diagram the survival of Titanic passengers, using the <a href="Data.html#Titanic">Titanic</a> dataset.</p>
<p>Alluvial diagrams are created with <code>ggalluvial</code> package, generating <code>ggplot2</code> graphs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># input data</span>
<span class="kw">library</span>(readr)
titanic &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;titanic.csv&quot;</span>)

<span class="co"># summarize data</span>
<span class="kw">library</span>(dplyr)
titanic_table &lt;-<span class="st"> </span>titanic <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(Class, Sex, Survived) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">count</span>()

titanic_table<span class="op">$</span>Survived &lt;-<span class="st"> </span><span class="kw">factor</span>(titanic_table<span class="op">$</span>Survived, 
                                 <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>))

<span class="kw">head</span>(titanic_table)</code></pre></div>
<pre><code>## # A tibble: 6 x 4
## # Groups:   Class, Sex, Survived [6]
##   Class Sex    Survived     n
##   &lt;chr&gt; &lt;chr&gt;  &lt;fct&gt;    &lt;int&gt;
## 1 1st   Female No           4
## 2 1st   Female Yes        141
## 3 1st   Male   No         118
## 4 1st   Male   Yes         62
## 5 2nd   Female No          13
## 6 2nd   Female Yes         93</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create alluvial diagram</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(ggalluvial)

<span class="kw">ggplot</span>(titanic_table,
       <span class="kw">aes</span>(<span class="dt">axis1 =</span> Class,
           <span class="dt">axis2 =</span> Survived,
           <span class="dt">y =</span> n)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_alluvium</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Sex)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_stratum</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">stat =</span> <span class="st">&quot;stratum&quot;</span>, 
            <span class="dt">label.strata =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Class&quot;</span>, <span class="st">&quot;Survived&quot;</span>),
                   <span class="dt">expand =</span> <span class="kw">c</span>(.<span class="dv">1</span>, .<span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Titanic data&quot;</span>,
       <span class="dt">subtitle =</span> <span class="st">&quot;stratified by class, sex, and survival&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Frequency&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_minimal</span>()</code></pre></div>
<div class="figure"><span id="fig:alluvial1"></span>
<img src="datavis_files/figure-html/alluvial1-1.png" alt="Basic alluvial diagram" width="672" />
<p class="caption">
Figure 9.9: Basic alluvial diagram
</p>
</div>
<p>Start at a node on the left and follow the stream field to the right. The height of the blocks represent the proportion of observations in that cluster and the height of the stream field represents the proportion of observations contained in both blocks they connect.</p>
<p>For example, most crew are male and do not survive. A much larger percent of 1st class females survive, than 1st class males.</p>
<p>Here is an alternative visualization. Survived becomes an axis and Class becomes the fill color. Colors are chosen from the <a href="Customizing.html#Viridis">viridis</a> palette. Additionally, the legend is suppressed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create alternative alluvial diagram</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(ggalluvial)
<span class="kw">ggplot</span>(titanic_table,
       <span class="kw">aes</span>(<span class="dt">axis1 =</span> Class,
           <span class="dt">axis2 =</span> Sex,
           <span class="dt">axis3 =</span> Survived,
           <span class="dt">y =</span> n)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_alluvium</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Class)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_stratum</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">stat =</span> <span class="st">&quot;stratum&quot;</span>, 
            <span class="dt">label.strata =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Class&quot;</span>, <span class="st">&quot;Sex&quot;</span>, <span class="st">&quot;Survived&quot;</span>),
                   <span class="dt">expand =</span> <span class="kw">c</span>(.<span class="dv">1</span>, .<span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_viridis_d</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Titanic data&quot;</span>,
       <span class="dt">subtitle =</span> <span class="st">&quot;stratified by class, sex, and survival&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Frequency&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) </code></pre></div>
<div class="figure"><span id="fig:alluvial2"></span>
<img src="datavis_files/figure-html/alluvial2-1.png" alt="Alternative alluvial diagram" width="672" />
<p class="caption">
Figure 9.10: Alternative alluvial diagram
</p>
</div>
<p>I think that this version is a bit easier to follow.</p>
<p>See the <a href="https://github.com/corybrunson/ggalluvial">ggalluvial website</a> for additional details.</p>
</div>
</div>
<div id="heatmaps" class="section level2">
<h2><span class="header-section-number">9.5</span> Heatmaps</h2>
<p>A heatmap displays a set of data using colored tiles for each variable value within each observation. There are many varieties of heatmaps. Although base R comes with a <code>heatmap</code> function, we’ll use the more powerful <a href="https://rlbarter.github.io/superheat/"><code>superheat</code></a> package (I love these names).</p>
<p>First, let’s create a heatmap for the <a href="https://www.rdocumentation.org/packages/datasets/versions/3.5.0/topics/mtcars"><code>mtcars</code></a> dataset that come with base R. The <code>mtcars</code> dataset contains information on 32 cars measured on 11 variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create a heatmap</span>
<span class="kw">data</span>(mtcars)
<span class="kw">library</span>(superheat)
<span class="kw">superheat</span>(mtcars, <span class="dt">scale =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div class="figure"><span id="fig:heatmap1"></span>
<img src="datavis_files/figure-html/heatmap1-1.png" alt="Basic heatmap" width="672" />
<p class="caption">
Figure 9.11: Basic heatmap
</p>
</div>
<p>The <code>scale = TRUE</code> options standardizes the columns to a mean of zero and standard deviation of one. Looking at the graph, we can see that the Merc 230 has a quarter mile time (<em>qsec</em>) the is well above average (bright yellow). The Lotus Europa has a weight is well below average (dark blue).</p>
<p>We can use clustering to sort the rows and/or columns. In the next example, we’ll sort the rows so that cars that are similar appear near each other. We will also adjust the text and label sizes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># sorted heat map</span>
<span class="kw">superheat</span>(mtcars,
          <span class="dt">scale =</span> <span class="ot">TRUE</span>,
          <span class="dt">left.label.text.size=</span><span class="dv">3</span>,
          <span class="dt">bottom.label.text.size=</span><span class="dv">3</span>,
          <span class="dt">bottom.label.size =</span> .<span class="dv">05</span>,
          <span class="dt">row.dendrogram =</span> <span class="ot">TRUE</span> )</code></pre></div>
<div class="figure"><span id="fig:heatmap2"></span>
<img src="datavis_files/figure-html/heatmap2-1.png" alt="Sorted heatmap" width="672" />
<p class="caption">
Figure 9.12: Sorted heatmap
</p>
</div>
<p>Here we can see that the Toyota Corolla and Fiat 128 have similar characteristics. The Lincoln Continental and Cadillac Fleetwood also have similar characteristics.</p>
<p>The <code>superheat</code> function requires that the data be in particular format. Specifically</p>
<ul>
<li>the data most be all numeric<br />
</li>
<li>the row names are used to label the left axis. If the desired labels are in a column variable, the variable must be converted to row names (more on this below)<br />
</li>
<li>missing values are allowed</li>
</ul>
<p>Let’s use a heatmap to display changes in life expectancies over time for Asian countries. The data come from the <a href="Data.html#Gapminder"><code>gapminder</code></a> dataset.</p>
<p>Since the data is in <a href="DataPrep.html#Reshaping">long format</a>, we first have to convert to wide format. Then we need to ensure that it is a data frame and convert the variable <em>country</em> into row names. Finally, we’ll sort the data by 2007 life expectancy. While we are at it, let’s change the color scheme.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create heatmap for gapminder data (Asia)</span>
<span class="kw">library</span>(tidyr)
<span class="kw">library</span>(dplyr)

<span class="co"># load data</span>
<span class="kw">data</span>(gapminder, <span class="dt">package=</span><span class="st">&quot;gapminder&quot;</span>)

<span class="co"># subset Asian countries</span>
asia &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(continent <span class="op">==</span><span class="st"> &quot;Asia&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(year, country, lifeExp)

<span class="co"># convert to long to wide format</span>
plotdata &lt;-<span class="st"> </span><span class="kw">spread</span>(asia, year, lifeExp)

<span class="co"># save country as row names</span>
plotdata &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(plotdata)
<span class="kw">row.names</span>(plotdata) &lt;-<span class="st"> </span>plotdata<span class="op">$</span>country
plotdata<span class="op">$</span>country &lt;-<span class="st"> </span><span class="ot">NULL</span>

<span class="co"># row order</span>
sort.order &lt;-<span class="st"> </span><span class="kw">order</span>(plotdata<span class="op">$</span><span class="st">&quot;2007&quot;</span>)

<span class="co"># color scheme</span>
<span class="kw">library</span>(RColorBrewer)
colors &lt;-<span class="st"> </span><span class="kw">rev</span>(<span class="kw">brewer.pal</span>(<span class="dv">5</span>, <span class="st">&quot;Blues&quot;</span>))


<span class="co"># create the heat map</span>
<span class="kw">superheat</span>(plotdata,
          <span class="dt">scale =</span> <span class="ot">FALSE</span>,
          <span class="dt">left.label.text.size=</span><span class="dv">3</span>,
          <span class="dt">bottom.label.text.size=</span><span class="dv">3</span>,
          <span class="dt">bottom.label.size =</span> .<span class="dv">05</span>,
          <span class="dt">heat.pal =</span> colors,
          <span class="dt">order.rows =</span> sort.order,
          <span class="dt">title =</span> <span class="st">&quot;Life Expectancy in Asia&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:heatmap3"></span>
<img src="datavis_files/figure-html/heatmap3-1.png" alt="Heatmap for time series" width="672" />
<p class="caption">
Figure 9.13: Heatmap for time series
</p>
</div>
<p>Japan, Hong Kong, and Israel have the highest life expectancies. South Korea was doing well in the 80s but has lost some ground. Life expectancy in Cambodia took a sharp hit in 1977.</p>
<p>To see what you can do with heat maps, see the extensive <code>superheat</code> <a href="https://rlbarter.github.io/superheat/">vignette</a>.</p>
</div>
<div id="radar-charts" class="section level2">
<h2><span class="header-section-number">9.6</span> Radar charts</h2>
<p>A radar chart (also called a spider or star chart) displays one or more groups or observations on three or more quantitative variables.</p>
<p>In the example below, we’ll compare dogs, pigs, and cows in terms of body size, brain size, and sleep characteristics (total sleep time, length of sleep cycle, and amount of REM sleep). The data come from the <a href="Data.html#Msleep">Mammal Sleep</a> dataset.</p>
<p>Radar charts can be created with <code>ggradar</code> function in the <code>ggradar</code> package. Unfortunately, the package in not available on CRAN, so we have to install it from Github.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)
devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;ricardo-bion/ggradar&quot;</span>)</code></pre></div>
<p>Next, we have to put the data in a specific format:</p>
<ul>
<li>The first variable should be called <em>group</em> and contain the identifier for each observation<br />
</li>
<li>The numeric variables have to be rescaled so that their values range from 0 to 1</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create a radar chart</span>

<span class="co"># prepare data</span>
<span class="kw">data</span>(msleep, <span class="dt">package =</span> <span class="st">&quot;ggplot2&quot;</span>)
<span class="kw">library</span>(ggradar)
<span class="kw">library</span>(scales)
<span class="kw">library</span>(dplyr)

plotdata &lt;-<span class="st"> </span>msleep <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(name <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Cow&quot;</span>, <span class="st">&quot;Dog&quot;</span>, <span class="st">&quot;Pig&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(name, sleep_total, sleep_rem, 
         sleep_cycle, brainwt, bodywt) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">group =</span> name) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="op">-</span>group),
            <span class="kw">funs</span>(rescale))
plotdata

<span class="co"># generate radar chart</span>
<span class="kw">ggradar</span>(plotdata, 
        <span class="dt">grid.label.size =</span> <span class="dv">4</span>,
        <span class="dt">axis.label.size =</span> <span class="dv">4</span>, 
        <span class="dt">group.point.size =</span> <span class="dv">5</span>,
        <span class="dt">group.line.width =</span> <span class="fl">1.5</span>,
        <span class="dt">legend.text.size=</span> <span class="dv">10</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Mammals, size, and sleep&quot;</span>)</code></pre></div>
<div class="figure">
<img src="img/radarchart.png" alt="Basic radar chart" />
<p class="caption">Basic radar chart</p>
</div>
<p>In the previous chart, the <code>mutate_at</code> function rescales all variables except <em>group</em>. The various <code>size</code> options control the font sizes for the percent labels, variable names, point size, line width, and legend labels respectively.</p>
<p>We can see from the chart that, relatively speaking, cows have large brain and body weights, long sleep cycles, short total sleep time and little time in REM sleep. Dogs in comparison, have small body and brain weights, short sleep cycles, and a large total sleep time and time in REM sleep (The obvious conclusion is that I want to be a dog - but with a bigger brain).</p>
</div>
<div id="scatterplot-matrix" class="section level2">
<h2><span class="header-section-number">9.7</span> Scatterplot matrix</h2>
<p>A scatterplot matrix is a collection of <a href="Bivariate.html#Scatterplot">scatterplots</a> organized as a grid. It is similar to a <a href="Models.html#Corrplot">correlation plot</a> but instead of displaying correlations, displays the underlying data.</p>
<p>You can create a scatterplot matrix using the <a href="https://ggobi.github.io/ggally/#ggallyggpairs"><code>ggpairs</code></a> function in the <a href="https://ggobi.github.io/ggally/index.html"><code>GGally</code></a> package.</p>
<p>We can illustrate its use by examining the relationships between mammal size and sleep characteristics. The data come from the <a href="Data.html#Msleep"><code>msleep</code></a> dataset that ships with <code>ggplot2</code>. Brain weight and body weight are highly skewed (think mouse and elephant) so we’ll transform them to log brain weight and log body weight before creating the graph.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(GGally)

<span class="co"># prepare data</span>
<span class="kw">data</span>(msleep, <span class="dt">package=</span><span class="st">&quot;ggplot2&quot;</span>)
<span class="kw">library</span>(dplyr)
df &lt;-<span class="st"> </span>msleep <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">log_brainwt =</span> <span class="kw">log</span>(brainwt),
         <span class="dt">log_bodywt =</span> <span class="kw">log</span>(bodywt)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(log_brainwt, log_bodywt, sleep_total, sleep_rem)
 

<span class="co"># create a scatterplot matrix</span>
<span class="kw">ggpairs</span>(df)</code></pre></div>
<div class="figure"><span id="fig:scatterplotmatrix2"></span>
<img src="datavis_files/figure-html/scatterplotmatrix2-1.png" alt="Scatterplot matrix" width="672" />
<p class="caption">
Figure 9.14: Scatterplot matrix
</p>
</div>
<p>By default,</p>
<ul>
<li>the principal diagonal contains the <a href="Univariate.html#Kernel">kernel density</a> charts for each variable.<br />
</li>
<li>The cells below the principal diagonal contain the scatterplots represented by the intersection of the row and column variables. The variables across the top are the <em>x</em>-axes and the variables down the right side are the <em>y</em>-axes.<br />
</li>
<li>The cells above the principal diagonal contain the correlation coefficients.</li>
</ul>
<p>For example, as brain weight increases, total sleep time and time in REM sleep decrease.</p>
<p>The graph can be modified by creating custom functions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># custom function for density plot</span>
my_density &lt;-<span class="st"> </span><span class="cf">function</span>(data, mapping, ...){
  <span class="kw">ggplot</span>(<span class="dt">data =</span> data, <span class="dt">mapping =</span> mapping) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>,
                 <span class="dt">fill =</span> <span class="st">&quot;cornflowerblue&quot;</span>, ...)
}

<span class="co"># custom function for scatterplot</span>
my_scatter &lt;-<span class="st"> </span><span class="cf">function</span>(data, mapping, ...){
  <span class="kw">ggplot</span>(<span class="dt">data =</span> data, <span class="dt">mapping =</span> mapping) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>,
               <span class="dt">color =</span> <span class="st">&quot;cornflowerblue&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span>lm, 
                <span class="dt">se=</span><span class="ot">FALSE</span>, ...)
}


<span class="co"># create scatterplot matrix</span>
<span class="kw">ggpairs</span>(df, 
        <span class="dt">lower=</span><span class="kw">list</span>(<span class="dt">continuous =</span> my_scatter), 
        <span class="dt">diag =</span> <span class="kw">list</span>(<span class="dt">continuous =</span> my_density)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Mammal size and sleep characteristics&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<div class="figure"><span id="fig:scatterplotmatrix3"></span>
<img src="datavis_files/figure-html/scatterplotmatrix3-1.png" alt="Customized scatterplot matrix" width="672" />
<p class="caption">
Figure 9.15: Customized scatterplot matrix
</p>
</div>
<p>Being able to write your own functions provides a great deal of flexibility. Additionally, since the resulting plot is a <code>ggplot2</code> graph, addition functions can be added to alter the theme, title, labels, etc. See the <a href="https://ggobi.github.io/ggally/#ggallyggpairs">help</a> for more details.</p>
</div>
<div id="waterfall-charts" class="section level2">
<h2><span class="header-section-number">9.8</span> Waterfall charts</h2>
<p>A waterfall chart illustrates the cumulative effect of a sequence of positive and negative values.</p>
<p>For example, we can plot the cumulative effect of revenue and expenses for a fictional company. First, let’s create a dataset</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create company income statement</span>
category &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Sales&quot;</span>, <span class="st">&quot;Services&quot;</span>, <span class="st">&quot;Fixed Costs&quot;</span>, 
              <span class="st">&quot;Variable Costs&quot;</span>, <span class="st">&quot;Taxes&quot;</span>)
amount &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">101000</span>, <span class="dv">52000</span>, <span class="op">-</span><span class="dv">23000</span>, <span class="op">-</span><span class="dv">15000</span>, <span class="op">-</span><span class="dv">10000</span>)
income &lt;-<span class="st"> </span><span class="kw">data.frame</span>(category, amount) </code></pre></div>
<p>Now we can visualize this with a waterfall chart, using the <a href="https://www.rdocumentation.org/packages/waterfalls/versions/0.1.2/topics/waterfall"><code>waterfall</code></a> function in the <code>waterfalls</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create waterfall chart</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(waterfalls)
<span class="kw">waterfall</span>(income) </code></pre></div>
<div class="figure"><span id="fig:waterfall2"></span>
<img src="datavis_files/figure-html/waterfall2-1.png" alt="Basic waterfall chart" width="672" />
<p class="caption">
Figure 9.16: Basic waterfall chart
</p>
</div>
<p>We can also add a total (net) column. Since the result is a <code>ggplot2</code> graph, we can use additional functions to customize the results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create waterfall chart with total column</span>
<span class="kw">waterfall</span>(income, 
          <span class="dt">calc_total=</span><span class="ot">TRUE</span>, 
          <span class="dt">total_axis_text =</span> <span class="st">&quot;Net&quot;</span>,
          <span class="dt">total_rect_text_color=</span><span class="st">&quot;black&quot;</span>,
          <span class="dt">total_rect_color=</span><span class="st">&quot;goldenrod1&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">label=</span>scales<span class="op">::</span>dollar) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;West Coast Profit and Loss&quot;</span>, 
       <span class="dt">subtitle =</span> <span class="st">&quot;Year 2017&quot;</span>,
       <span class="dt">y=</span><span class="st">&quot;&quot;</span>, 
       <span class="dt">x=</span><span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_minimal</span>() </code></pre></div>
<div class="figure"><span id="fig:waterfall3"></span>
<img src="datavis_files/figure-html/waterfall3-1.png" alt="Waterfall chart with total column" width="672" />
<p class="caption">
Figure 9.17: Waterfall chart with total column
</p>
</div>
</div>
<div id="word-clouds" class="section level2">
<h2><span class="header-section-number">9.9</span> Word clouds</h2>
<p>A word cloud (also called a tag cloud), is basically an infographic that indicates the frequency of words in a collection of text (e.g., tweets, a text document, a set of text documents). There is a very nice script produced by <a href="http://www.sthda.com">STHDA</a> that will generate a word cloud directly from a text file.</p>
<p>To demonstrate, we’ll use <a href="Data.html#JFKspeech">President Kennedy’s Address</a> during the Cuban Missile crisis.</p>
<p>To use the script, there are several packages you need to install first.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install packages for text mining</span>
<span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">&quot;tm&quot;</span>, <span class="st">&quot;SnowballC&quot;</span>, 
                   <span class="st">&quot;wordcloud&quot;</span>, <span class="st">&quot;RColorBrewer&quot;</span>, 
                   <span class="st">&quot;RCurl&quot;</span>, <span class="st">&quot;XML&quot;</span>)</code></pre></div>
<p>Once the packages are installed, you can run the script on your text file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create a word cloud</span>
script &lt;-<span class="st"> &quot;http://www.sthda.com/upload/rquery_wordcloud.r&quot;</span>
<span class="kw">source</span>(script)
res&lt;-<span class="kw">rquery.wordcloud</span>(<span class="st">&quot;JFKspeech.txt&quot;</span>, 
                      <span class="dt">type =</span><span class="st">&quot;file&quot;</span>, 
                      <span class="dt">lang =</span> <span class="st">&quot;english&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:wordcloud2"></span>
<img src="datavis_files/figure-html/wordcloud2-1.png" alt="Word cloud" width="672" />
<p class="caption">
Figure 9.18: Word cloud
</p>
</div>
<p>As you can see, the most common words in the speech are <em>soviet</em>, <em>cuba</em>, <em>world</em>, <em>weapons</em>, etc. The terms <em>missle</em> and <em>ballistic</em> are used rarely. See the <a href="http://www.sthda.com/english/wiki/word-cloud-generator-in-r-one-killer-function-to-do-everything-you-need">rquery.wordcloud page</a>, for more details.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Customizing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rkabacoff/datavis/edit/master/09-specialized.Rmd",
"text": "Edit"
},
"download": ["datavis.pdf", "datavis.epub", "datavis.mobi"],
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
