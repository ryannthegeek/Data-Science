<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/>
<script data-ezscrex='false' data-cfasync='false' data-pagespeed-no-defer>var __ez=__ez||{};__ez.stms=Date.now();__ez.evt={};__ez.script={};__ez.ck=__ez.ck||{};__ez.template={};__ez.template.isOrig=true;__ez.queue=(function(){var count=0,incr=0,items=[],timeDelayFired=false,hpItems=[],lpItems=[],allowLoad=true;var obj={func:function(name,funcName,parameters,isBlock,blockedBy,deleteWhenComplete,proceedIfError){var self=this;this.name=name;this.funcName=funcName;this.parameters=parameters===null?null:(parameters instanceof Array)?parameters:[parameters];this.isBlock=isBlock;this.blockedBy=blockedBy;this.deleteWhenComplete=deleteWhenComplete;this.isError=false;this.isComplete=false;this.isInitialized=false;this.proceedIfError=proceedIfError;this.isTimeDelay=false;this.process=function(){log("... func = "+name);self.isInitialized=true;self.isComplete=true;log("... func.apply: "+name);var funcs=self.funcName.split('.');var func=null;if(funcs.length>3){}else if(funcs.length===3){func=window[funcs[0]][funcs[1]][funcs[2]];}else if(funcs.length===2){func=window[funcs[0]][funcs[1]];}else{func=window[self.funcName];}
if(typeof func!=='undefined'&&func!==null){func.apply(null,this.parameters);}
if(self.deleteWhenComplete===true)delete items[name];if(self.isBlock===true){log("----- F'D: "+self.name);processAll();}}},file:function(name,path,isBlock,blockedBy,async,defer,proceedIfError){var self=this;this.name=name;this.path=path;this.async=async;this.defer=defer;this.isBlock=isBlock;this.blockedBy=blockedBy;this.isInitialized=false;this.isError=false;this.isComplete=false;this.proceedIfError=proceedIfError;this.isTimeDelay=false;this.process=function(){self.isInitialized=true;log("... file = "+name);var scr=document.createElement('script');scr.src=path;if(async===true)scr.async=true;else if(defer===true)scr.defer=true;scr.onerror=function(){log("----- ERR'D: "+self.name);self.isError=true;if(self.isBlock===true){processAll();}};scr.onreadystatechange=scr.onload=function(){var state=scr.readyState;log("----- F'D: "+self.name);if((!state||/loaded|complete/.test(state))){self.isComplete=true;if(self.isBlock===true){processAll();}}};document.getElementsByTagName('head')[0].appendChild(scr);}},fileLoaded:function(name,isComplete){this.name=name;this.path="";this.async=false;this.defer=false;this.isBlock=false;this.blockedBy=[];this.isInitialized=true;this.isError=false;this.isComplete=isComplete;this.proceedIfError=false;this.isTimeDelay=false;this.process=function(){};}};function init(){window.addEventListener("load",function(){setTimeout(function(){timeDelayFired=true;log('TDELAY -----');processAll();},5000);},false);}
function addFile(name,path,isBlock,blockedBy,async,defer,proceedIfError,priority){var item=new obj.file(name,path,isBlock,blockedBy,async,defer,proceedIfError);if(priority===true){hpItems[name]=item}else{lpItems[name]=item}
items[name]=item;checkIfBlocked(item);}
function setallowLoad(settobool){allowLoad=settobool}
function addFunc(name,func,parameters,isBlock,blockedBy,autoInc,deleteWhenComplete,proceedIfError,priority){if(autoInc===true)name=name+"_"+incr++;var item=new obj.func(name,func,parameters,isBlock,blockedBy,deleteWhenComplete,proceedIfError);if(priority===true){hpItems[name]=item}else{lpItems[name]=item}
items[name]=item;checkIfBlocked(item);}
function addTimeDelayFile(name,path){var item=new obj.file(name,path,false,[],false,false,true);item.isTimeDelay=true;log(name+' ... '+' FILE! TDELAY');lpItems[name]=item;items[name]=item;checkIfBlocked(item);}
function addTimeDelayFunc(name,func,parameters){var item=new obj.func(name,func,parameters,false,[],true,true);item.isTimeDelay=true;log(name+' ... '+' FUNCTION! TDELAY');lpItems[name]=item;items[name]=item;checkIfBlocked(item);}
function checkIfBlocked(item){if(isBlocked(item)===true||allowLoad==false)return;item.process();}
function isBlocked(item){if(item.isTimeDelay===true&&timeDelayFired===false){log(item.name+" blocked = TIME DELAY!");return true;}
if(item.blockedBy instanceof Array){for(var i=0;i<item.blockedBy.length;i++){var block=item.blockedBy[i];if(items.hasOwnProperty(block)===false){log(item.name+" blocked = "+block);return true;}else if(item.proceedIfError===true&&items[block].isError===true){return false;}else if(items[block].isComplete===false){log(item.name+" blocked = "+block);return true;}}}
return false;}
function markLoaded(filename){if(!filename||0===filename.length){return;}
if(filename in items){var item=items[filename];if(item.isComplete===true){log(item.name+' '+filename+': error loaded duplicate')}else{item.isComplete=true;item.isInitialized=true;}}else{items[filename]=new obj.fileLoaded(filename,true);}
log("markLoaded dummyfile: "+items[filename].name);}
function logWhatsBlocked(){for(var i in items){if(items.hasOwnProperty(i)===false)continue;var item=items[i];isBlocked(item)}}
function log(msg){var href=window.location.href;var reg=new RegExp('[?&]ezq=([^&#]*)','i');var string=reg.exec(href);var res=string?string[1]:null;if(res==="1")console.debug(msg);}
function processAll(){count++;if(count>200)return;log("let's go");processItems(hpItems);processItems(lpItems);}
function processItems(list){for(var i in list){if(list.hasOwnProperty(i)===false)continue;var item=list[i];if(item.isComplete===true||isBlocked(item)||item.isInitialized===true||item.isError===true){if(item.isError===true){log(item.name+': error')}else if(item.isComplete===true){log(item.name+': complete already')}else if(item.isInitialized===true){log(item.name+': initialized already')}}else{item.process();}}}
init();return{addFile:addFile,addDelayFile:addTimeDelayFile,addFunc:addFunc,addDelayFunc:addTimeDelayFunc,items:items,processAll:processAll,setallowLoad:setallowLoad,markLoaded:markLoaded,logWhatsBlocked:logWhatsBlocked,};})();__ez.evt.add=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n()},__ez.evt.remove=function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):delete e["on"+t]};__ez.script.add=function(e){var t=document.createElement("script");t.src=e,t.async=!0,t.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(t)};__ez.dot={};__ez.queue.addFile('/detroitchicago/boise.js', '/detroitchicago/boise.js?gcb=195-0&cb=1', true, [], true, false, true, false);__ez.queue.addFile('/detroitchicago/memphis.js', '/detroitchicago/memphis.js?gcb=195-0&cb=14', true, [], true, false, true, false);__ez.queue.addFile('/detroitchicago/minneapolis.js', '/detroitchicago/minneapolis.js?gcb=195-0&cb=3', true, [], true, false, true, false);__ez.queue.addFile('/detroitchicago/rochester.js', '/detroitchicago/rochester.js?gcb=195-0&cb=12', false, ['/detroitchicago/memphis.js','/detroitchicago/minneapolis.js'], true, false, true, false);__ez.vep=(function(){var pixels=[],pxURL="/detroitchicago/grapefruit.gif";function AddPixel(vID,pixelData){if(__ez.dot.isDefined(vID)&&__ez.dot.isValid(pixelData)){pixels.push({type:'video',video_impression_id:vID,domain_id:__ez.dot.getDID(),t_epoch:__ez.dot.getEpoch(0),data:__ez.dot.dataToStr(pixelData)});}}
function Fire(){if(typeof document.visibilityState!=='undefined'&&document.visibilityState==="prerender"){return;}
if(__ez.dot.isDefined(pixels)&&pixels.length>0){while(pixels.length>0){var j=5;if(j>pixels.length){j=pixels.length;}
var pushPixels=pixels.splice(0,j);var pixelURL=__ez.dot.getURL(pxURL)+"?orig="+(__ez.template.isOrig===true?1:0)+"&v="+btoa(JSON.stringify(pushPixels));__ez.dot.Fire(pixelURL);}}
pixels=[];}
return{Add:AddPixel,Fire:Fire};})();</script><script data-ezscrex='false' data-cfasync='false' data-pagespeed-no-defer>__ez.pel=(function(){var pixels=[],pxURL="/porpoiseant/army.gif";function AddAndFirePixel(adSlot,pixelData){AddPixel(adSlot,pixelData,0,0,0,0,0);Fire();}
function AddAndFireOrigPixel(adSlot,pixelData){AddPixel(adSlot,pixelData,0,0,0,0,0,true);Fire();}
function GetCurrentPixels(){return pixels;}
function AddPixel(adSlot,pixelData,revenue,est_revenue,bid_floor_filled,bid_floor_prev,stat_source_id,isOrig){if(!__ez.dot.isDefined(adSlot)||__ez.dot.isAnyDefined(adSlot.getSlotElementId,adSlot.ElementId)==false){return;}
if(typeof isOrig==='undefined'){isOrig=false;}
var ad_position_id=parseInt(__ez.dot.getTargeting(adSlot,'ap'));var impId=__ez.dot.getSlotIID(adSlot),adUnit=__ez.dot.getAdUnit(adSlot,isOrig);var compId=parseInt(__ez.dot.getTargeting(adSlot,"compid"));var lineItemId=0;var creativeId=0;var ezimData=getEzimData(adSlot);if(typeof ezimData=='object'){if(ezimData.creative_id!==undefined){creativeId=ezimData.creative_id;}
if(ezimData.line_item_id!==undefined){lineItemId=ezimData.line_item_id;}}
if(__ez.dot.isDefined(impId,adUnit)&&__ez.dot.isValid(pixelData)){if((impId!=="0"||isOrig===true)&&adUnit!==""){pixels.push({type:"impression",impression_id:impId,domain_id:__ez.dot.getDID(),unit:adUnit,t_epoch:__ez.dot.getEpoch(0),revenue:revenue,est_revenue:est_revenue,ad_position:ad_position_id,ad_size:"",bid_floor_filled:bid_floor_filled,bid_floor_prev:bid_floor_prev,stat_source_id:stat_source_id,country_code:__ez.dot.getCC(),pageview_id:__ez.dot.getPageviewId(),comp_id:compId,line_item_id:lineItemId,creative_id:creativeId,data:__ez.dot.dataToStr(pixelData),is_orig:isOrig||__ez.template.isOrig,});}}}
function AddPixelById(impFullId,pixelData,isOrig,revenue){var vals=impFullId.split('/');if(__ez.dot.isDefined(impFullId)&&vals.length===3&&__ez.dot.isValid(pixelData)){var adUnit=vals[0],impId=vals[2];var pix={type:"impression",impression_id:impId,domain_id:__ez.dot.getDID(),unit:adUnit,t_epoch:__ez.dot.getEpoch(0),pageview_id:__ez.dot.getPageviewId(),data:__ez.dot.dataToStr(pixelData),is_orig:isOrig||__ez.template.isOrig};if(typeof revenue!=='undefined'){pix.revenue=revenue;}
pixels.push(pix);}}
function Fire(){if(typeof document.visibilityState!=='undefined'&&document.visibilityState==="prerender")return;if(__ez.dot.isDefined(pixels)&&pixels.length>0){var allPixels=[pixels.filter(function(pixel){return pixel.is_orig}),pixels.filter(function(pixel){return!pixel.is_orig})];allPixels.forEach(function(pixels){while(pixels.length>0){var isOrig=pixels[0].is_orig||false;var j=5;if(j>pixels.length){j=pixels.length;}
var pushPixels=pixels.splice(0,j);var pixelURL=__ez.dot.getURL(pxURL)+"?orig="+(isOrig===true?1:0)+"&sts="+btoa(JSON.stringify(pushPixels));if(typeof window.isAmp!=='undefined'&&isAmp&&typeof window._ezaq!=='undefined'&&_ezaq.hasOwnProperty("domain_id")){pixelURL+="&visit_uuid="+_ezaq['visit_uuid'];}
__ez.dot.Fire(pixelURL);}});}
pixels=[];}
function getEzimData(adSlot){if(typeof _ezim_d=="undefined"){return false;}
var adUnitName=__ez.dot.getAdUnitPath(adSlot).split('/').pop();if(typeof _ezim_d==='object'&&_ezim_d.hasOwnProperty(adUnitName)){return _ezim_d[adUnitName];}
for(var ezimKey in _ezim_d){if(ezimKey.split('/').pop()===adUnitName){return _ezim_d[ezimKey];}}
return false;}
return{Add:AddPixel,AddAndFire:AddAndFirePixel,AddAndFireOrig:AddAndFireOrigPixel,AddById:AddPixelById,Fire:Fire,GetPixels:GetCurrentPixels,};})();__ez.queue.addFile('/detroitchicago/raleigh.js', '/detroitchicago/raleigh.js?gcb=195-0&cb=5', false, [], true, false, true, false);__ez.queue.addFile('/detroitchicago/tampa.js', '/detroitchicago/tampa.js?gcb=195-0&cb=4', false, [], true, false, true, false);</script>
<script data-ezscrex="false" data-cfasync="false">(function(){if("function"===typeof window.CustomEvent)return!1;window.CustomEvent=function(c,a){a=a||{bubbles:!1,cancelable:!1,detail:null};var b=document.createEvent("CustomEvent");b.initCustomEvent(c,a.bubbles,a.cancelable,a.detail);return b}})();</script><script data-ezscrex="false" data-cfasync="false">__ez.queue.addFile('/detroitchicago/tulsa.js', '/detroitchicago/tulsa.js?gcb=195-0&cb=5', false, [], true, false, true, false);</script>

  <!-- Google Analytics + OutboundLink + Google Adsense -->
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-79254642-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-79254642-1');
  </script>
  <script>
  var getOutboundLink = function(url) {
    gtag('event', 'click', {
      'event_category': 'outbound',
      'event_label': url,
      'transport_type': 'beacon',
      'event_callback': function(){document.location = url;}
    });
  }
  </script>
  <script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-3523953066677938",
            enable_page_level_ads: true
       });
  </script>
  <!-- Google Analytics + OutboundLink + Google Adsense -->



<title>Bubble map with ggplot2 – the R Graph Gallery</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="generator" content="pandoc"/>
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
<meta name="description" content="This post explains how to build a bubble map with ggplot2. It takes a list of GPS coordinates and plot them on top of a map, with size and color mapped to data."/>
<meta name="keywords" content="R,ggplot2,tidyverse,Example,Data,Dataviz,Datavisualization,Plot,Chart,Graph,Learning,Caveat,Pitfall,Mistake"/>
<meta name="author" content="Yan Holtz"/>
<link rel="icon" href="img/logo/R_single_small.png"/>

<!-- Control appearance when shared by social media -->
<meta property="og:title" content="Bubble map with ggplot2"/>
<meta property="og:image" content="img/overview_RGG.png"/>
<meta property="og:description" content="This post explains how to build a bubble map with ggplot2. It takes a list of GPS coordinates and plot them on top of a map, with size and color mapped to data."/>
<meta property="og:url" content="https://www.r-graph-gallery.com/330-bubble-map-with-ggplot2.html"/>
<meta property="og:type" content="website"/>

<!-- Bootstrap core CSS -->
<link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet"/>

<!-- Custom fonts for this template -->
<link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>

<!-- Custom styles for this template -->
<link href="css/agency.css" rel="stylesheet"/>

<!-- JQUERY -->
<script src="vendor/jquery/jquery.min.js"></script>

<link rel='canonical' href='https://r-graph-gallery.com/330-bubble-map-with-ggplot2.html' />
<script type="text/javascript">var ezouid = "1";</script><base href="https://r-graph-gallery.com/330-bubble-map-with-ggplot2.html"><script type='text/javascript'>
var ezoTemplate = 'old_site_gc';
if(typeof ezouid == 'undefined')
{
    var ezouid = 'none';
}
var ezoFormfactor = '1';
var ezo_elements_to_check = Array();
</script><!-- START EZHEAD -->
<script data-ezscrex="false" type='text/javascript'>
var soc_app_id = '0';
var did = 242358;
var ezdomain = 'r-graph-gallery.com';
var ezoicSearchable = 1;
</script>
<!--{jquery}-->
<!-- END EZHEAD -->
<script data-ezscrex="false" type="text/javascript" data-cfasync="false">var _ezaq = {"ad_cache_level":0,"ad_lazyload_version":0,"ad_load_version":0,"city":"Nairobi","country":"KE","days_since_last_visit":-1,"domain_id":242358,"engaged_time_visit":0,"ezcache_level":2,"ezcache_skip_code":0,"form_factor_id":1,"framework_id":1,"is_return_visitor":false,"is_sitespeed":0,"last_page_load":"","last_pageview_id":"","lt_cache_level":0,"metro_code":0,"page_ad_positions":"","page_view_count":4,"page_view_id":"ae190148-7710-4acd-4b70-7ebf502fc054","position_selection_id":0,"postal_code":"","pv_event_count":0,"response_size_orig":40995,"response_time_orig":3,"serverid":"3.70.168.236:22349","state":"30","t_epoch":1649175572,"template_id":126,"time_on_site_visit":0,"url":"https://r-graph-gallery.com/330-bubble-map-with-ggplot2.html","user_id":0,"weather_precipitation":0,"weather_summary":"","weather_temperature":0,"word_count":1471,"worst_bad_word_level":0};var _ezExtraQueries = "&ez_orig=1";</script>
<script data-ezscrex='false' data-pagespeed-no-defer data-cfasync='false'>
function create_ezolpl(pvID, rv) {
    var d = new Date();
    d.setTime(d.getTime() + (365*24*60*60*1000));
    var expires = "expires="+d.toUTCString();
    __ez.ck.setByCat("ezux_lpl_242358=" + new Date().getTime() + "|" + pvID + "|" + rv + "; " + expires, 3);
}
function attach_ezolpl(pvID, rv) {
    if (document.readyState === "complete") {
        create_ezolpl(pvID, rv);
    }
    if(window.attachEvent) {
        window.attachEvent("onload", create_ezolpl, pvID, rv);
    } else {
        if(window.onload) {
            var curronload = window.onload;
            var newonload = function(evt) {
                curronload(evt);
                create_ezolpl(pvID, rv);
            };
            window.onload = newonload;
        } else {
            window.onload = create_ezolpl.bind(null, pvID, rv);
        }
    }
}

__ez.queue.addFunc("attach_ezolpl", "attach_ezolpl", ["ae190148-7710-4acd-4b70-7ebf502fc054", "false"], false, ['/detroitchicago/boise.js'], true, false, false, false);
</script></head>





<body data-spy="scroll" data-target="#myScrollspy" data-offset="1">


<!-- THIS ALLOWS TO INSERT THE MENU THAT IS STORED IN A MENU.HTML FILE-->
<nav class="navbar navbar-expand-lg fixed-top" id="mainNav"></nav>
<script>
  $(function(){
    $("#mainNav").load("html_chunk/menu.html");
  });
</script>

<!-- THIS ALLOWS TO INSERT THE MODAL OF THE MENU THAT IS STORED IN A MENU_MODAL.HTML FILE-->
<div id="modal_menu_insertion"> </div>
<script>
  $(function(){
    $("#modal_menu_insertion").load("html_chunk/menu_modal.html");
  });
</script>



<!-- Header = Title in big + social media Icon + quick description -->
<header class="masthead" style="padding-bottom: 30px;">
  <div class="textlanding">
      <center><h1>Bubble map with ggplot2</h1></center>
      <hr class="short_hr"/>
      <br/>
      <ul class="list-inline social-buttons">
        <li class="list-inline-item">
          <a href="https://twitter.com/R_Graph_Gallery">
            <i class="fa fa-twitter"></i>
          </a>
        </li>
        <li class="list-inline-item social-buttons">
          <a href="https://github.com/holtzy">
            <i class="fa fa-github" style="color: white"></i>
          </a>
        </li>
        <li class="list-inline-item social-buttons">
          <a href="https://www.linkedin.com/in/yan-holtz-2477534a/">
            <i class="fa fa-linkedin"></i>
          </a>
        </li>
        <li class="list-inline-item social-buttons">
          <a href="https://www.yan-holtz.com">
            <i class="fa fa-home"></i>
          </a>
        </li>
      </ul>
      <center><p style="max-width: 600px; margin-top: 40px">This post explains how to build a <a href="bubble-map.html">bubble map</a> with <a href="ggplot2-package.html">ggplot2</a>. It takes a list of GPS coordinates and plot them on top of a map, with size and color mapped to data.</p></center>
      <div style="text-align:center">
         <a class="btn btn-secondary btn-xl text-uppercase js-scroll-trigger" href="bubble-map.html">Bubble map section</a>
         <a class="btn btn-secondary btn-xl text-uppercase js-scroll-trigger" href="https://www.data-to-viz.com/graph/bubblemap.html">About Maps</a>
      </div>
  </div>
</header>



<!-- THIS ALLOWS TO INSERT THE ADVERTISEMENT BANNER THAT IS STORED IN A BANNER.HTML FILE-->
<div id="position_for_images"></div>
<script>
  $(function(){
    $("#position_for_images").load("html_chunk/images.html");
  });
</script>










<!-- STYLE for chart pages but not the rest of tthe website -->
<style>
  img {
    margin-top: 20px;
  }
</style>



<div class="container" style="padding-top: 100px">
<div class="row">
<div class="col-md-6 col-sm-12 align-self-center">
<p><img src="img/graph/330-bubble-map-with-ggplot2.png" alt="bubble map with R and ggplot2" width="100%"/></p>
</div>
<div class="col-md-6 col-sm-12 align-self-center">
<p>This post explains how to make a <a href="bubble-map.html">bubble map</a> with <a href="ggplot2-package.html">ggplot2</a>.</p>
<p>A bubble map is like a <a href="bubble-chart.html">bubble chart</a>, but with a map in the background. As input you need:</p>
<ul>
<li>a list of GPS coordinates (longitude and latitude of the places you want to represent)</li>
<li>a numeric variable used for bubble color and size</li>
</ul>
<p>This post provides a step-by-step approach to build the map beside, showing the 1000 biggest cities of the UK.</p>
<h1 id="load-data">Load data</h1>
<hr/>
<p>The first step is to get the boundaries of the zone that interests you. Several option are available in R, as extensively described in the <a href="map.html">background map</a> section of the gallery.</p>
<p>Briefly, you can find this information somewhere under the <a href="168-load-a-shape-file-into-r.html">shapefile</a> format or under the <a href="325-background-map-from-geojson-format-in-r.html">geoJSON</a> format. You can also load google like backgrounds with the <a href="324-map-background-with-the-ggmap-library.html">ggmap</a> library.</p>
<p>This post uses the last approach: it loads the <code>maps</code> package that provides the boundaries of every world country.</p>
</div>
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Libraries</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"> </a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co"># Get the world polygon and extract UK</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">library</span>(maps)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">UK &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&#34;world&#34;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(region<span class="op">==</span><span class="st">&#34;UK&#34;</span>)</a></code></pre></div>
<p><br/></p>
<p>The second step is to load a data frame with the info of the bubble you want to draw. The <code>maps</code> library provides a list of the biggest cities in the world. Let’s use it to get information on the UK.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Get a data frame with longitude, latitude, and size of bubbles (a bubble = a city)</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">data &lt;-<span class="st"> </span>world.cities <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(country.etc<span class="op">==</span><span class="st">&#34;UK&#34;</span>)</a></code></pre></div>
<h1 id="scatter">Basic scatterplot map</h1>
<hr/>
<p><code>ggplot2</code> makes it a breeze to map both information on the same graph. Use <code>geom_polygon</code> for the shape of UK first, and add your scatterplot on it with <code>geom_point()</code>.</p>
<p>On the right figure, note the use of the <code>ggrepel</code> library to avoid overlapping between city names.</p>
<p><img src="330-bubble-map-with-ggplot2_files/figure-html/thecode-1.png" width="50%"/><img src="330-bubble-map-with-ggplot2_files/figure-html/thecode-2.png" width="50%"/></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># Left chart</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> UK, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), <span class="dt">fill=</span><span class="st">&#34;grey&#34;</span>, <span class="dt">alpha=</span><span class="fl">0.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_point</span>( <span class="dt">data=</span>data, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="st">  </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="dv">50</span>,<span class="dv">59</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_map</span>() </a>
<a class="sourceLine" id="cb3-6" data-line-number="6"> </a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co"># Second graphic with names of the 10 biggest cities</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="kw">library</span>(ggrepel)</a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> UK, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), <span class="dt">fill=</span><span class="st">&#34;grey&#34;</span>, <span class="dt">alpha=</span><span class="fl">0.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_point</span>( <span class="dt">data=</span>data, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">alpha=</span>pop)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_text_repel</span>( <span class="dt">data=</span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(pop) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tail</span>(<span class="dv">10</span>), <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">label=</span>name), <span class="dt">size=</span><span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_point</span>( <span class="dt">data=</span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(pop) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tail</span>(<span class="dv">10</span>), <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat), <span class="dt">color=</span><span class="st">&#34;red&#34;</span>, <span class="dt">size=</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="st">  </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="dv">50</span>,<span class="dv">59</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_map</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&#34;none&#34;</span>)</a></code></pre></div>
<h1 id="bubble">Basic bubble map</h1>
<hr/>
<p>Now we want to add another information. The number of inhabitant per city will be mapped to the colour and the size of the bubbles. Note that the order of city matters! It is advised to show the most important information on top (center). This can been done sorting your dataset before making the plot.</p>
<p><img src="330-bubble-map-with-ggplot2_files/figure-html/thecode5-1.png" width="33%"/><img src="330-bubble-map-with-ggplot2_files/figure-html/thecode5-2.png" width="33%"/><img src="330-bubble-map-with-ggplot2_files/figure-html/thecode5-3.png" width="33%"/></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># virids package for the color palette</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">library</span>(viridis)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"> </a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co"># Left: use size and color</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> UK, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), <span class="dt">fill=</span><span class="st">&#34;grey&#34;</span>, <span class="dt">alpha=</span><span class="fl">0.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_point</span>( <span class="dt">data=</span>data, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">size=</span>pop, <span class="dt">color=</span>pop)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_size_continuous</span>(<span class="dt">range=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">12</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_color_viridis</span>(<span class="dt">trans=</span><span class="st">&#34;log&#34;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="st">  </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="dv">50</span>,<span class="dv">59</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_map</span>() </a>
<a class="sourceLine" id="cb4-11" data-line-number="11"> </a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co"># Center: reorder your dataset first! Big cities appear later = on top</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13">data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="st"> </span><span class="kw">arrange</span>(pop) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="st"> </span><span class="kw">mutate</span>( <span class="dt">name=</span><span class="kw">factor</span>(name, <span class="kw">unique</span>(name))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="st">    </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> UK, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), <span class="dt">fill=</span><span class="st">&#34;grey&#34;</span>, <span class="dt">alpha=</span><span class="fl">0.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="st">    </span><span class="kw">geom_point</span>( <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">size=</span>pop, <span class="dt">color=</span>pop), <span class="dt">alpha=</span><span class="fl">0.9</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="st">    </span><span class="kw">scale_size_continuous</span>(<span class="dt">range=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">12</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="st">    </span><span class="kw">scale_color_viridis</span>(<span class="dt">trans=</span><span class="st">&#34;log&#34;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="dv">50</span>,<span class="dv">59</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_map</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&#34;none&#34;</span>)</a>
<a class="sourceLine" id="cb4-22" data-line-number="22"> </a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co"># Right: just use arrange(desc(pop)) instead</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24">data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(pop)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="st"> </span><span class="kw">mutate</span>( <span class="dt">name=</span><span class="kw">factor</span>(name, <span class="kw">unique</span>(name))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"><span class="st">    </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> UK, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), <span class="dt">fill=</span><span class="st">&#34;grey&#34;</span>, <span class="dt">alpha=</span><span class="fl">0.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="st">    </span><span class="kw">geom_point</span>( <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">size=</span>pop, <span class="dt">color=</span>pop), <span class="dt">alpha=</span><span class="fl">0.9</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-30" data-line-number="30"><span class="st">    </span><span class="kw">scale_size_continuous</span>(<span class="dt">range=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">12</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-31" data-line-number="31"><span class="st">    </span><span class="kw">scale_color_viridis</span>(<span class="dt">trans=</span><span class="st">&#34;log&#34;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="dv">50</span>,<span class="dv">59</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_map</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&#34;none&#34;</span>)</a></code></pre></div>
<h1 id="custom">Customized bubble map</h1>
<hr/>
<div class="row">
<div class="col-md-6 col-sm-12 align-self-center">
<p><img src="img/graph/330-bubble-map-with-ggplot2.png" alt="bubble map with R and ggplot2" width="100%"/></p>
</div>
<div class="col-md-6 col-sm-12 align-self-center">
<p>We can custom a little bit this figure for a better looking result (first image of this post).</p>
<p>Note that here the legend shows both the size, the color and the transparency on the same circles. This is possible only if these 3 informations are redondante, with the same name, transformation and breaks.</p>
</div>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Create breaks for the color scale</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">mybreaks &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.02</span>, <span class="fl">0.04</span>, <span class="fl">0.08</span>, <span class="dv">1</span>, <span class="dv">7</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co"># Reorder data to show biggest cities on top</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">data &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="st">  </span><span class="kw">arrange</span>(pop) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>( <span class="dt">name=</span><span class="kw">factor</span>(name, <span class="kw">unique</span>(name))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pop=</span>pop<span class="op">/</span><span class="dv">1000000</span>) </a>
<a class="sourceLine" id="cb5-9" data-line-number="9"></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co"># Build the map</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11">map <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="st">    </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> UK, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), <span class="dt">fill=</span><span class="st">&#34;grey&#34;</span>, <span class="dt">alpha=</span><span class="fl">0.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="st">    </span><span class="kw">geom_point</span>(  <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">size=</span>pop, <span class="dt">color=</span>pop, <span class="dt">alpha=</span>pop), <span class="dt">shape=</span><span class="dv">20</span>, <span class="dt">stroke=</span><span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="st">    </span><span class="kw">scale_size_continuous</span>(<span class="dt">name=</span><span class="st">&#34;Population (in M)&#34;</span>, <span class="dt">trans=</span><span class="st">&#34;log&#34;</span>, <span class="dt">range=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">12</span>), <span class="dt">breaks=</span>mybreaks) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="st">    </span><span class="kw">scale_alpha_continuous</span>(<span class="dt">name=</span><span class="st">&#34;Population (in M)&#34;</span>, <span class="dt">trans=</span><span class="st">&#34;log&#34;</span>, <span class="dt">range=</span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">.9</span>), <span class="dt">breaks=</span>mybreaks) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="st">    </span><span class="kw">scale_color_viridis</span>(<span class="dt">option=</span><span class="st">&#34;magma&#34;</span>, <span class="dt">trans=</span><span class="st">&#34;log&#34;</span>, <span class="dt">breaks=</span>mybreaks, <span class="dt">name=</span><span class="st">&#34;Population (in M)&#34;</span> ) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="dv">50</span>,<span class="dv">59</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_map</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="st">    </span><span class="kw">guides</span>( <span class="dt">colour =</span> <span class="kw">guide_legend</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&#34;The 1000 biggest cities in the UK&#34;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="st">    </span><span class="kw">theme</span>(</a>
<a class="sourceLine" id="cb5-22" data-line-number="22">      <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.85</span>, <span class="fl">0.8</span>),</a>
<a class="sourceLine" id="cb5-23" data-line-number="23">      <span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> <span class="st">&#34;#22211d&#34;</span>),</a>
<a class="sourceLine" id="cb5-24" data-line-number="24">      <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&#34;#f5f5f2&#34;</span>, <span class="dt">color =</span> <span class="ot">NA</span>), </a>
<a class="sourceLine" id="cb5-25" data-line-number="25">      <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&#34;#f5f5f2&#34;</span>, <span class="dt">color =</span> <span class="ot">NA</span>), </a>
<a class="sourceLine" id="cb5-26" data-line-number="26">      <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&#34;#f5f5f2&#34;</span>, <span class="dt">color =</span> <span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb5-27" data-line-number="27">      <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span> <span class="dv">16</span>, <span class="dt">hjust=</span><span class="fl">0.1</span>, <span class="dt">color =</span> <span class="st">&#34;#4e4d47&#34;</span>, <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">b =</span> <span class="fl">-0.1</span>, <span class="dt">t =</span> <span class="fl">0.4</span>, <span class="dt">l =</span> <span class="dv">2</span>, <span class="dt">unit =</span> <span class="st">&#34;cm&#34;</span>)),</a>
<a class="sourceLine" id="cb5-28" data-line-number="28">    )</a></code></pre></div>
<h1 id="interactive">Interactive bubble map with plotly</h1>
<hr/>
<div class="row">
<div class="col-md-8 col-sm-12 align-self-center">
<center>
<iframe src="HtmlWidget/bubblemapUK.html" width="100%" height="600px" style="border:none">
</iframe>
</center>
</div>
<div class="col-md-4 col-sm-12 align-self-center">
<p>Last but not least, plotly allows to quickly get an interactive version. This is really handy since it allows to zoom on the map and hover a city to know its name and population!</p>
</div>
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># Load the plotly package</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">library</span>(plotly)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"> </a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co"># Rorder data + Add a new column with tooltip text</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">data &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="st">  </span><span class="kw">arrange</span>(pop) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>( <span class="dt">name=</span><span class="kw">factor</span>(name, <span class="kw">unique</span>(name))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>( <span class="dt">mytext=</span><span class="kw">paste</span>(</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">    <span class="st">&#34;City: &#34;</span>, name, <span class="st">&#34;</span><span class="ch">\n</span><span class="st">&#34;</span>, </a>
<a class="sourceLine" id="cb6-10" data-line-number="10">    <span class="st">&#34;Population: &#34;</span>, pop, <span class="dt">sep=</span><span class="st">&#34;&#34;</span>)</a>
<a class="sourceLine" id="cb6-11" data-line-number="11">  )</a>
<a class="sourceLine" id="cb6-12" data-line-number="12"> </a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co"># Make the map (static)</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14">p &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="st">    </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> UK, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), <span class="dt">fill=</span><span class="st">&#34;grey&#34;</span>, <span class="dt">alpha=</span><span class="fl">0.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">size=</span>pop, <span class="dt">color=</span>pop, <span class="dt">text=</span>mytext, <span class="dt">alpha=</span>pop) ) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="st">    </span><span class="kw">scale_size_continuous</span>(<span class="dt">range=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">15</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="st">    </span><span class="kw">scale_color_viridis</span>(<span class="dt">option=</span><span class="st">&#34;inferno&#34;</span>, <span class="dt">trans=</span><span class="st">&#34;log&#34;</span> ) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="st">    </span><span class="kw">scale_alpha_continuous</span>(<span class="dt">trans=</span><span class="st">&#34;log&#34;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="st">    </span><span class="kw">ylim</span>(<span class="dv">50</span>,<span class="dv">59</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="st">    </span><span class="kw">coord_map</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&#34;none&#34;</span>)</a>
<a class="sourceLine" id="cb6-25" data-line-number="25"> </a>
<a class="sourceLine" id="cb6-26" data-line-number="26">p &lt;-<span class="st"> </span><span class="kw">ggplotly</span>(p, <span class="dt">tooltip=</span><span class="st">&#34;text&#34;</span>)</a>
<a class="sourceLine" id="cb6-27" data-line-number="27">p</a>
<a class="sourceLine" id="cb6-28" data-line-number="28"></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="co"># save the widget in a html file if needed.</span></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="co"># library(htmlwidgets)</span></a>
<a class="sourceLine" id="cb6-31" data-line-number="31"><span class="co"># saveWidget(p, file=paste0( getwd(), &#34;/HtmlWidget/bubblemapUK.html&#34;))</span></a></code></pre></div>
<!-- Close container -->
</div>
<!-- ============================ RELATED SECTION ============================ -->
<section class="bg-light" id="portfolio_landing" style="padding-top: 30px; padding-bottom: 30px; margin-top: 100px;">

<div class="container">

  <p class="mySeryTitle">Related chart types</p>
  <hr/>
  <div class="row">
    <div class="col-md-2 col-sm-4 portfolio-item">
      <a class="portfolio-link" href="map.html">
        <div class="portfolio-hover">
          <div class="portfolio-hover-content">
            <i class="fa fa-plus fa-3x"></i>
          </div>
        </div>
        <img class="img-fluid" src="img/section/Map150.png" alt=""/>
      </a>
      <div class="captionPortfolio">Map</div>
    </div>
    <div class="col-md-2 col-sm-4 portfolio-item">
      <a class="portfolio-link" href="choropleth-map.html">
        <div class="portfolio-hover">
          <div class="portfolio-hover-content">
            <i class="fa fa-plus fa-3x"></i>
          </div>
        </div>
        <img class="img-fluid" src="img/section/Choropleth150.png" alt=""/>
      </a>
      <div class="captionPortfolio">Choropleth</div>
    </div>
    <div class="col-md-2 col-sm-4 portfolio-item">
      <a class="portfolio-link" href="hexbin-map.html">
        <div class="portfolio-hover">
          <div class="portfolio-hover-content">
            <i class="fa fa-plus fa-3x"></i>
          </div>
        </div>
        <img class="img-fluid" src="img/section/MapHexbin150.png" alt=""/>
      </a>
      <div class="captionPortfolio">Hexbin map</div>
    </div>
    <div class="col-md-2 col-sm-4 portfolio-item">
      <a class="portfolio-link" href="cartogram.html">
        <div class="portfolio-hover">
          <div class="portfolio-hover-content">
            <i class="fa fa-plus fa-3x"></i>
          </div>
        </div>
        <img class="img-fluid" src="img/section/Cartogram150.png" alt=""/>
      </a>
      <div class="captionPortfolio">Cartogram</div>
    </div>
    <div class="col-md-2 col-sm-4 portfolio-item">
      <a class="portfolio-link" href="connection-map.html">
        <div class="portfolio-hover">
          <div class="portfolio-hover-content">
            <i class="fa fa-plus fa-3x"></i>
          </div>
        </div>
        <img class="img-fluid" src="img/section/ConnectedMap150.png" alt=""/>
      </a>
      <div class="captionPortfolio">Connection</div>
    </div>
    <div class="col-md-2 col-sm-4 portfolio-item">
      <a class="portfolio-link" href="bubble-map.html">
        <div class="portfolio-hover">
          <div class="portfolio-hover-content">
            <i class="fa fa-plus fa-3x"></i>
          </div>
        </div>
        <img class="img-fluid" src="img/section/BubbleMap150.png" alt=""/>
      </a>
      <div class="captionPortfolio">Bubble map</div>
    </div>
  </div>

</div>
</section>






<!-- ============================ CONTACT SECTION ============================ -->
<section id="contact" class="bg" style="background-color: white; padding-top: 60px">
  <div class="container">
    <div class="row">
      <div class="col-lg-2 text-center"></div>
      <div class="col-lg-8 text-center">
        <br/><br/><br/>
        <h2 class="section-heading text-uppercase" style="color: black">Contact</h2>
        <p>This document is a work by <a href="https://www.yan-holtz.com">Yan Holtz</a>. Any feedback is highly encouraged. You can fill an issue on <a href="https://github.com/holtzy/D3-graph-gallery/issues">Github</a>, drop me a message on <a href="https://twitter.com/R_Graph_Gallery">Twitter</a>, or send an email pasting <a href="">yan.holtz.data</a> with <a href="">gmail.com</a>.</p>
        <div style="text-align:center">
           <a class="btn btn-primary btn-xl text-uppercase js-scroll-trigger" href="https://github.com/holtzy">Github</a>
           <a class="btn btn-primary btn-xl text-uppercase js-scroll-trigger" href="https://twitter.com/R_Graph_Gallery">Twitter</a>
         </div>
      </div>
    </div>
  </div>
</section>



<!-- ============================ FOOTER SECTION ============================ -->
<footer class="bg-light" id="myFooter">
  <div class="container">
    <div class="row">
      <div class="col-md-4">
        <span class="copyright">Copyright © the R graph gallery 2018</span>
      </div>
      <div class="col-md-4">
        <ul class="list-inline social-buttons">
          <li class="list-inline-item">
            <a href="https://twitter.com/R_Graph_Gallery">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
          <li class="list-inline-item">
            <a href="https://github.com/holtzy">
              <i class="fa fa-github"></i>
            </a>
          </li>
          <li class="list-inline-item">
            <a href="https://www.linkedin.com/in/yan-holtz-2477534a/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
        </ul>
      </div>
      <div class="col-md-4">
        <ul class="list-inline quicklinks">
          <li class="list-inline-item">
            <a href="#">Privacy Policy</a>
          </li>
          <li class="list-inline-item">
            <a href="#">Terms of Use</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</footer>




<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>



<!-- ============================ JAVASCRIPT SECTION ============================ -->

<!-- Bootstrap core JavaScript -->
<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

<!-- Custom scripts for this template -->
<script src="js/agency.min.js"></script>



<script type='text/javascript' style='display:none;' async>
__ez.queue.addFile('/detroitchicago/edmonton.webp', '/detroitchicago/edmonton.webp?a=a&cb=0&shcb=34', true, ['/detroitchicago/minneapolis.js'], true, false, false, false);
__ez.queue.addFile('/porpoiseant/jellyfish.webp', '/porpoiseant/jellyfish.webp?a=a&cb=0&shcb=34', false, [], true, false, false, false);
</script>

<script>var _audins_dom="r_graph_gallery_com",_audins_did=242358;__ez.queue.addDelayFunc("audins.js","__ez.script.add", "//go.ezoic.net/detroitchicago/audins.js?cb=195-0");</script><noscript><div style="display:none;"><img src="//pixel.quantserve.com/pixel/p-31iz6hfFutd16.gif?labels=Domain.r_graph_gallery_com,DomainId.242358" border="0" height="1" width="1" alt="Quantcast"/></div></noscript>
<script type="text/javascript" data-cfasync="false"></script>
<script>__ez.queue.addFile('/tardisrocinante/vitals.js', '/tardisrocinante/vitals.js?gcb=0&cb=3', false, ['/detroitchicago/minneapolis.js'], true, false, true, false);</script></body></html>