{"title":"A case study on automobile dataset","markdown":{"yaml":{"title":"A case study on automobile dataset"},"headingText":"Importing Datasets","containsRefs":false,"markdown":"\n\n\n\n### Statement of the problem\n\nTom wants to sell his car, how much should he sell it? Help him determine the best  for his car.\n\nHere are the questions you should ask yourself as a data scientist.\n\n- Is there data on the prices of other cars and their characteristics? \n- What features of cars affect their prices? \n- Color? Brand? Horsepower? Something else? \n- Asking the right questions in terms of data\n\n### Python packages for data science\n\n- **Scientifics Computing Libraries**\n    + `Numpy`: arrays and matrices\n    + `Pandas`: Data structures and tools\n- **Visualization Libraries**\n    + `Matplotlib`: Plots, graphs, most popular\n    + `Seaborn`: advanced plotting, time series, violin plots\n- **Algorithmic libraries**\n    + `Scikit-learn`: machine learning: regression, classification,...\n    + `Statsmodels`: explore data, estimation of statistical models and perform statistical tests\n\n\n\n- **Global settings**\n\n### Data Description\n\n![Automobile data description](automobile%20data%20description.png)\n\n## Data Wrangling/munging/cleaning/preprocessing\n\nThis is the process of cleaning and transforming raw data into a format suitable for analysis.\n\nIt involves various tasks, including:\n- removing duplicates\n- handling missing values\n- converting data types\n- merging datasets\n\n### Dealing with Missing Data\n \n- Missing values occur when no data value is stored for a variable (feature) in an observation. \n- Could be represented as \"?\" \"N/A\", 0 or just a blank cell.\n\n**How to deal with missing data**\n\n- Check with the data collection source \n- Drop the missing values \n    + drop the variable\n    + drop the data entry \n- Replace the missing values \n    + replace it with an average (of similar datapoints) \n    + replace it by frequency \n    + interpolate missing values\n    + replace it based on other functions\n- Leave it as missing data\n\n\n### Data formatting\n\n- Putting data into a correct format for further processing and analysis\n\n### Data normalization\n\n### Binning in python\n\n- **Binning:** Grouping of values into \"bins\" \n- Converts numeric into categorical variables \n- Group a set of numerical values into a set of \"bins\"\n\nLet's bin prices column by categorizing them into low, medium, high\n\n\n## Exploratory Data Analysis\n\n- Preliminary step in data analysis to: \n    + Summarize main characteristics of the data \n    + Gain better understanding of the data set \n    + Uncover relationships between variables \n    + Extract important variables \n\n::: callout-note\n**Question:** \n \"What are the characteristics which have the most impact on the car price?\"  \n:::\n\n### Descriptive statistics\n\n- Describe basic features of data \n- Giving short summaries about the sample and measures of the data\n\n\n- Summarize the categorical variable using the `value_counts` function\n\n**Box Plot Example**\n\n**Scatter Plot Example**\n\n- There is a positive correlation between price and engine size\n\n### `groupby()` Function\n\n- The `pivot_table()` method\n\n### Correlation\n\n- When the highway miles per gallon value goes high, the price goes high.\n- There is a positive linear correlation between price of the vehicle and its engine size.\n- This means that engine size is a good predictor for price.\n-  The slope of correlation is positive\n\n- When the highway miles per gallon value goes high, the price goes down.\n- There is a negative linear relationship between price of the vehicle and its highway miles per gallon (mpg).\n-  The slope of correlation is negative.\n- This means that engine size is a good predictor for price indicated by the steepness of the slope.\n- These two variables are said to have negative correlation\n\n- There is a weak correlation between the two variables\n- The slope is almost zero\n- peak-rpm is therefore a poor predictor for price\n\n### Correlation statistics\n\n- Measure of the strength of the correlation among variables of interest\n    + Correlation coefficient: $-1<\\rho<1$ \n    + p value\n\n- Correlation for numeric variables only in a more general way\n\n- Correlation and p value for numeric only variables\n\n- A heatmap that shows the correlations between one variable and another\n\n### Association between two categorical variables: $\\chi^2$ test\n\n- Chi-square tests for null hypothesis that variables are independent\n- The Chi-square does not tell you the type of relationship that exists between both variables; but only that a relationship exists.\n\n\nThe table above contains observed values from the dataset.\n\n- The table above shows the expected frequencies of the two variables after applying chi square test.\n\n- Testing at 5% level of significance\n- P-value $<$ 0.05, we reject the null hypothesis that the two variables are independent and conclude that there is evidence of association between fuel-type and aspiration.\n- You can also use the test statistic in comparison to the critical value to assess whether the two variables are independent or not.\n\n## Model Development\n\nIn this module you will learn about:   \n1. Simple and Multiple Linear Regression \n2. Model Evaluation using Visualization \n3. Polynomial Regression and Pipelines \n4. R-squared and MSE for In-Sample Evaluation \n5. Prediction and Decision Making \n\n::: callout-note\n**Question:**  \nHow can you determine a fair value for a used car?\n\n### Linear Regression and Multiple Linear regression\n\n**Simple linear regresssion**\n\n**PLEASE FIND TIME TO INTEPRETE THESE ALL OUPUTS.**\n\n**Multiple Linear Regression**\n\n**PLEASE FIND TIME TO INTEPRETE THESE ALL OUPUTS.**\n\n### Model Evaluation Using Visualization\n\n**A distribution plot**\n- A distribution plot displays the predicted values vs the actual values.\n\n- The actual values are in red. We see the predicted values for prices in the range from 40,000 to 50,000 are inaccurate.\n- The prices in the region from 10,000 to 20,000 are much closer to the target value.\n\n- In this example, we use multiple features or independent variables.\n- Comparing it to the plot on the last slide, we see predicted values are much closer to the target values.\n\n### Polynomial regression\n\n- A special case of the general linear regression\n- Useful for describing curvilinear relationships\n- **Curvilinear relationships:** Squaring or setting higher-order terms of the predictor variables\n- Exists in three forms:\n    - Quadratic - second order\n    - Cubic - third order\n    - Higher order\n\n#### One-dimensional Polynomial Regression\n\n- This incorporates only one predictor variable\n- Easy to implement\n- No scaling needed since it has one predictor variable\n\n- The Relationship between price and highway-mpg looks like a poynomial of degree 5-10, lets try:\n\n- The results show that the third and higher orders are insignificant at 5% significance level, lets reduce to second order\n\n- The process of trial and error is abit tidious, lets use cross-validation to evaluate perfomance of models and pick the best to determine the optimal degree order\n\n#### Multi-dimensional Polynomial Regression\n\n- This incorporates more than one predictor variable\n- Scaling(Normalizing) is needed to ensure standardizing of the data\n\nLooking at the scatter plot above, scaling is needed\n\nThe plot shows that highway-mpg has negative relationship with price. Lets omit it and work with the rest\n\n### Measures for in-sample evaluation\n\n- Mean squared error\n- Coefficient of determination $R^2$\n\n### Prediction and Decision Making\n\nDecision making:\n\n1. Numerical measures for evaluation: MSE, RMSE among others\n2. Visualization: residual plot, regression plot among others\n3. Do the predicted values make sense: make a point prediction\n4. Comparing models: MLR, SLR and Polynomial\n\n::: callout-tip\n##### NOTE\nLets compute RMSE and see if predicted values makes sense\n:::\n\n- RMSE\n\n- Make Point predictions of new data\n\n## Model Evaluation\n\n- Tells how the model performs in real world\n\n### Model Evaluation and Refinement\n\nLet's fit polynomial regression that we have learnt to predict price of a vehicle\n\n- Split the data into training and testing sets\n\n\nLet's fit polynomial regression that we have learnt to predict price of a vehicle\n\n- Split the data into training and testing sets\n\nLet's fit multiple linear regression model instead since there is are no aspects of polynomial regression on the dataset\n\n- Split the data into training and testing sets\n\n### Ridge regression\n\n- Ridge regression prevents overfitting\n- We will use the refined predictor variable prescribed by the multiple linear regression as significant\n\n- Perform ridge regression\n\n### GridSearch\n\n- GridSearch allows us to search into multiple free parameters\n- Parameters like alpha, as discussed on ridge regression are not part of the fitting or training process, this values are called\n    hyperparameters\n- Scikit-Learn has a means of iterating over the hyperparameters using cross-validation called gridsearch\n\n- Print the scores of different free parameters\n","srcMarkdownNoYaml":"\n\n\n\n## Importing Datasets\n### Statement of the problem\n\nTom wants to sell his car, how much should he sell it? Help him determine the best  for his car.\n\nHere are the questions you should ask yourself as a data scientist.\n\n- Is there data on the prices of other cars and their characteristics? \n- What features of cars affect their prices? \n- Color? Brand? Horsepower? Something else? \n- Asking the right questions in terms of data\n\n### Python packages for data science\n\n- **Scientifics Computing Libraries**\n    + `Numpy`: arrays and matrices\n    + `Pandas`: Data structures and tools\n- **Visualization Libraries**\n    + `Matplotlib`: Plots, graphs, most popular\n    + `Seaborn`: advanced plotting, time series, violin plots\n- **Algorithmic libraries**\n    + `Scikit-learn`: machine learning: regression, classification,...\n    + `Statsmodels`: explore data, estimation of statistical models and perform statistical tests\n\n\n\n- **Global settings**\n\n### Data Description\n\n![Automobile data description](automobile%20data%20description.png)\n\n## Data Wrangling/munging/cleaning/preprocessing\n\nThis is the process of cleaning and transforming raw data into a format suitable for analysis.\n\nIt involves various tasks, including:\n- removing duplicates\n- handling missing values\n- converting data types\n- merging datasets\n\n### Dealing with Missing Data\n \n- Missing values occur when no data value is stored for a variable (feature) in an observation. \n- Could be represented as \"?\" \"N/A\", 0 or just a blank cell.\n\n**How to deal with missing data**\n\n- Check with the data collection source \n- Drop the missing values \n    + drop the variable\n    + drop the data entry \n- Replace the missing values \n    + replace it with an average (of similar datapoints) \n    + replace it by frequency \n    + interpolate missing values\n    + replace it based on other functions\n- Leave it as missing data\n\n\n### Data formatting\n\n- Putting data into a correct format for further processing and analysis\n\n### Data normalization\n\n### Binning in python\n\n- **Binning:** Grouping of values into \"bins\" \n- Converts numeric into categorical variables \n- Group a set of numerical values into a set of \"bins\"\n\nLet's bin prices column by categorizing them into low, medium, high\n\n\n## Exploratory Data Analysis\n\n- Preliminary step in data analysis to: \n    + Summarize main characteristics of the data \n    + Gain better understanding of the data set \n    + Uncover relationships between variables \n    + Extract important variables \n\n::: callout-note\n**Question:** \n \"What are the characteristics which have the most impact on the car price?\"  \n:::\n\n### Descriptive statistics\n\n- Describe basic features of data \n- Giving short summaries about the sample and measures of the data\n\n\n- Summarize the categorical variable using the `value_counts` function\n\n**Box Plot Example**\n\n**Scatter Plot Example**\n\n- There is a positive correlation between price and engine size\n\n### `groupby()` Function\n\n- The `pivot_table()` method\n\n### Correlation\n\n- When the highway miles per gallon value goes high, the price goes high.\n- There is a positive linear correlation between price of the vehicle and its engine size.\n- This means that engine size is a good predictor for price.\n-  The slope of correlation is positive\n\n- When the highway miles per gallon value goes high, the price goes down.\n- There is a negative linear relationship between price of the vehicle and its highway miles per gallon (mpg).\n-  The slope of correlation is negative.\n- This means that engine size is a good predictor for price indicated by the steepness of the slope.\n- These two variables are said to have negative correlation\n\n- There is a weak correlation between the two variables\n- The slope is almost zero\n- peak-rpm is therefore a poor predictor for price\n\n### Correlation statistics\n\n- Measure of the strength of the correlation among variables of interest\n    + Correlation coefficient: $-1<\\rho<1$ \n    + p value\n\n- Correlation for numeric variables only in a more general way\n\n- Correlation and p value for numeric only variables\n\n- A heatmap that shows the correlations between one variable and another\n\n### Association between two categorical variables: $\\chi^2$ test\n\n- Chi-square tests for null hypothesis that variables are independent\n- The Chi-square does not tell you the type of relationship that exists between both variables; but only that a relationship exists.\n\n\nThe table above contains observed values from the dataset.\n\n- The table above shows the expected frequencies of the two variables after applying chi square test.\n\n- Testing at 5% level of significance\n- P-value $<$ 0.05, we reject the null hypothesis that the two variables are independent and conclude that there is evidence of association between fuel-type and aspiration.\n- You can also use the test statistic in comparison to the critical value to assess whether the two variables are independent or not.\n\n## Model Development\n\nIn this module you will learn about:   \n1. Simple and Multiple Linear Regression \n2. Model Evaluation using Visualization \n3. Polynomial Regression and Pipelines \n4. R-squared and MSE for In-Sample Evaluation \n5. Prediction and Decision Making \n\n::: callout-note\n**Question:**  \nHow can you determine a fair value for a used car?\n\n### Linear Regression and Multiple Linear regression\n\n**Simple linear regresssion**\n\n**PLEASE FIND TIME TO INTEPRETE THESE ALL OUPUTS.**\n\n**Multiple Linear Regression**\n\n**PLEASE FIND TIME TO INTEPRETE THESE ALL OUPUTS.**\n\n### Model Evaluation Using Visualization\n\n**A distribution plot**\n- A distribution plot displays the predicted values vs the actual values.\n\n- The actual values are in red. We see the predicted values for prices in the range from 40,000 to 50,000 are inaccurate.\n- The prices in the region from 10,000 to 20,000 are much closer to the target value.\n\n- In this example, we use multiple features or independent variables.\n- Comparing it to the plot on the last slide, we see predicted values are much closer to the target values.\n\n### Polynomial regression\n\n- A special case of the general linear regression\n- Useful for describing curvilinear relationships\n- **Curvilinear relationships:** Squaring or setting higher-order terms of the predictor variables\n- Exists in three forms:\n    - Quadratic - second order\n    - Cubic - third order\n    - Higher order\n\n#### One-dimensional Polynomial Regression\n\n- This incorporates only one predictor variable\n- Easy to implement\n- No scaling needed since it has one predictor variable\n\n- The Relationship between price and highway-mpg looks like a poynomial of degree 5-10, lets try:\n\n- The results show that the third and higher orders are insignificant at 5% significance level, lets reduce to second order\n\n- The process of trial and error is abit tidious, lets use cross-validation to evaluate perfomance of models and pick the best to determine the optimal degree order\n\n#### Multi-dimensional Polynomial Regression\n\n- This incorporates more than one predictor variable\n- Scaling(Normalizing) is needed to ensure standardizing of the data\n\nLooking at the scatter plot above, scaling is needed\n\nThe plot shows that highway-mpg has negative relationship with price. Lets omit it and work with the rest\n\n### Measures for in-sample evaluation\n\n- Mean squared error\n- Coefficient of determination $R^2$\n\n### Prediction and Decision Making\n\nDecision making:\n\n1. Numerical measures for evaluation: MSE, RMSE among others\n2. Visualization: residual plot, regression plot among others\n3. Do the predicted values make sense: make a point prediction\n4. Comparing models: MLR, SLR and Polynomial\n\n::: callout-tip\n##### NOTE\nLets compute RMSE and see if predicted values makes sense\n:::\n\n- RMSE\n\n- Make Point predictions of new data\n\n## Model Evaluation\n\n- Tells how the model performs in real world\n\n### Model Evaluation and Refinement\n\nLet's fit polynomial regression that we have learnt to predict price of a vehicle\n\n- Split the data into training and testing sets\n\n\nLet's fit polynomial regression that we have learnt to predict price of a vehicle\n\n- Split the data into training and testing sets\n\nLet's fit multiple linear regression model instead since there is are no aspects of polynomial regression on the dataset\n\n- Split the data into training and testing sets\n\n### Ridge regression\n\n- Ridge regression prevents overfitting\n- We will use the refined predictor variable prescribed by the multiple linear regression as significant\n\n- Perform ridge regression\n\n### GridSearch\n\n- GridSearch allows us to search into multiple free parameters\n- Parameters like alpha, as discussed on ridge regression are not part of the fitting or training process, this values are called\n    hyperparameters\n- Scikit-Learn has a means of iterating over the hyperparameters using cross-validation called gridsearch\n\n- Print the scores of different free parameters\n"},"formats":{"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"png","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":false,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":"H","fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","toc":true,"toc-depth":4,"number-sections":true,"listings":true,"include-in-header":["D:\\Chege Learners' Hub\\quarto learning\\listsetP.tex","D:\\Chege Learners' Hub\\quarto learning\\contactdets.tex"],"output-file":"Data Analysis with Python Book"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"block-headings":true,"jupyter":"python3","documentclass":"report","classoption":["12pt","a4paper","oneside","openright"],"toc-title":"Contents","toccolor":"blue","number-depth":3,"lof":true,"lot":true,"urlcolor":"purple","colorlinks":true,"linkcolor":"blue","filecolor":"magenta","citecolor":"blue","link-citations":true,"title":"A case study on automobile dataset"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["pdf"]}